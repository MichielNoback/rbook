<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 19 Exercise solutions | Data Analysis and Visualization using R</title>
<meta name="author" content="Michiel Noback">
<meta name="description" content="19.1 Getting started  19.1.1 Install the tools No solution for this one.   19.2 The toolbox  19.2.1 Customize RStudio No solution for this one.  19.2.2 Résumé No solution for this one.   19.3...">
<meta name="generator" content="bookdown 0.29 with bs4_book()">
<meta property="og:title" content="Chapter 19 Exercise solutions | Data Analysis and Visualization using R">
<meta property="og:type" content="book">
<meta property="og:description" content="19.1 Getting started  19.1.1 Install the tools No solution for this one.   19.2 The toolbox  19.2.1 Customize RStudio No solution for this one.  19.2.2 Résumé No solution for this one.   19.3...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 19 Exercise solutions | Data Analysis and Visualization using R">
<meta name="twitter:description" content="19.1 Getting started  19.1.1 Install the tools No solution for this one.   19.2 The toolbox  19.2.1 Customize RStudio No solution for this one.  19.2.2 Résumé No solution for this one.   19.3...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.2/transition.js"></script><script src="libs/bs3compat-0.4.2/tabs.js"></script><script src="libs/bs3compat-0.4.2/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/htmlwidgets-1.6.1/htmlwidgets.js"></script><link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding-0.27/datatables.js"></script><link href="libs/dt-core-1.12.1/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core-1.12.1/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core-1.12.1/js/jquery.dataTables.min.js"></script><link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script><script src="libs/plotly-binding-4.10.4/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Data Analysis and Visualization using R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Getting started</a></li>
<li><a class="" href="toolbox.html"><span class="header-section-number">2</span> The toolbox</a></li>
<li><a class="" href="basic-r.html"><span class="header-section-number">3</span> Basic R</a></li>
<li><a class="" href="complex-datatypes-and-file-reading.html"><span class="header-section-number">4</span> Complex Datatypes and File Reading</a></li>
<li><a class="" href="ggplot2.html"><span class="header-section-number">5</span> Basics of the ggplot2 package</a></li>
<li><a class="" href="built-in-functions.html"><span class="header-section-number">6</span> Built-in Functions</a></li>
<li><a class="" href="flow-control-and-scripting.html"><span class="header-section-number">7</span> Flow control and scripting</a></li>
<li><a class="" href="tidyr.html"><span class="header-section-number">8</span> Tidying dataframes using Package tidyr</a></li>
<li><a class="" href="mangling.html"><span class="header-section-number">9</span> Old school data mangling</a></li>
<li><a class="" href="dplyr.html"><span class="header-section-number">10</span> Data mangling with dplyr</a></li>
<li><a class="" href="regex.html"><span class="header-section-number">11</span> Text processing with regex</a></li>
<li><a class="" href="ggplot2-adv.html"><span class="header-section-number">12</span> Package ggplot2 revisited</a></li>
<li><a class="" href="date-time.html"><span class="header-section-number">13</span> Working with date-time data</a></li>
<li><a class="" href="eda-1.html"><span class="header-section-number">14</span> Exploratory Data Analysis I</a></li>
<li><a class="" href="eda-2.html"><span class="header-section-number">15</span> Exploratory Data Analysis II</a></li>
<li><a class="" href="adding-interactivity.html"><span class="header-section-number">16</span> Adding interactivity</a></li>
<li><a class="" href="packages.html"><span class="header-section-number">17</span> Packages</a></li>
<li><a class="" href="exercises.html"><span class="header-section-number">18</span> Exercises</a></li>
<li><a class="active" href="exercise-solutions.html"><span class="header-section-number">19</span> Exercise solutions</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="exercise-solutions" class="section level1" number="19">
<h1>
<span class="header-section-number">19</span> Exercise solutions<a class="anchor" aria-label="anchor" href="#exercise-solutions"><i class="fas fa-link"></i></a>
</h1>
<div id="getting-started-3" class="section level2" number="19.1">
<h2>
<span class="header-section-number">19.1</span> Getting started<a class="anchor" aria-label="anchor" href="#getting-started-3"><i class="fas fa-link"></i></a>
</h2>
<div id="install-the-tools-1" class="section level3" number="19.1.1">
<h3>
<span class="header-section-number">19.1.1</span> Install the tools<a class="anchor" aria-label="anchor" href="#install-the-tools-1"><i class="fas fa-link"></i></a>
</h3>
<p>No solution for this one.</p>
</div>
</div>
<div id="the-toolbox-1" class="section level2" number="19.2">
<h2>
<span class="header-section-number">19.2</span> The toolbox<a class="anchor" aria-label="anchor" href="#the-toolbox-1"><i class="fas fa-link"></i></a>
</h2>
<div id="customize-rstudio-1" class="section level3" number="19.2.1">
<h3>
<span class="header-section-number">19.2.1</span> Customize RStudio<a class="anchor" aria-label="anchor" href="#customize-rstudio-1"><i class="fas fa-link"></i></a>
</h3>
<p>No solution for this one.</p>
</div>
<div id="résumé" class="section level3" number="19.2.2">
<h3>
<span class="header-section-number">19.2.2</span> Résumé<a class="anchor" aria-label="anchor" href="#r%C3%A9sum%C3%A9"><i class="fas fa-link"></i></a>
</h3>
<p>No solution for this one.</p>
</div>
</div>
<div id="basic-r-2" class="section level2" number="19.3">
<h2>
<span class="header-section-number">19.3</span> Basic R<a class="anchor" aria-label="anchor" href="#basic-r-2"><i class="fas fa-link"></i></a>
</h2>
<div id="math-in-the-console-1" class="section level3" number="19.3.1">
<h3>
<span class="header-section-number">19.3.1</span> Math in the console<a class="anchor" aria-label="anchor" href="#math-in-the-console-1"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb974"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">31</span> <span class="op">+</span> <span class="fl">11</span></span>
<span><span class="fl">66</span> <span class="op">-</span> <span class="fl">24</span></span>
<span><span class="fl">126</span> <span class="op">/</span> <span class="fl">3</span></span>
<span><span class="fl">12</span><span class="op">^</span><span class="fl">2</span> </span>
<span><span class="fl">256</span><span class="op">**</span><span class="fl">0.5</span></span>
<span><span class="op">(</span><span class="fl">3</span> <span class="op">*</span> <span class="op">(</span><span class="fl">4</span> <span class="op">+</span> <span class="fl">8</span><span class="op">^</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">5</span><span class="op">^</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 42
## [1] 42
## [1] 42
## [1] 144
## [1] 16
## [1] 0.164</code></pre>
</div>
<div id="functions-i-1" class="section level3" number="19.3.2">
<h3>
<span class="header-section-number">19.3.2</span> Functions (I)<a class="anchor" aria-label="anchor" href="#functions-i-1"><i class="fas fa-link"></i></a>
</h3>
<p><strong>A</strong><br>
Answer: <code><a href="https://rdrr.io/r/base/paste.html">paste()</a></code> and <code><a href="https://rdrr.io/r/base/paste.html">paste0()</a></code>. The difference lies in the <em>separator</em>, which is an empty string in <code><a href="https://rdrr.io/r/base/paste.html">paste0()</a></code> and one space in <code><a href="https://rdrr.io/r/base/paste.html">paste()</a></code>. Moreover, the separator can be configured in <code><a href="https://rdrr.io/r/base/paste.html">paste()</a></code> using the <code>sep =</code> parameter.</p>
<div class="sourceCode" id="cb976"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"welcome "</span>, <span class="st">"to "</span>, <span class="st">"R"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"welcome "</span>, <span class="st">"to "</span>, <span class="st">"R"</span><span class="op">)</span></span></code></pre></div>
<p><strong>B</strong><br>
Answer: <code><a href="https://rdrr.io/r/base/MathFun.html">abs()</a></code> returns the <em>absolute</em> value. Simply put, a number with the minus sign removed if present.</p>
<div class="sourceCode" id="cb977"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="op">-</span><span class="fl">20</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 20</code></pre>
<div class="sourceCode" id="cb979"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 20</code></pre>
<p><strong>C</strong><br>
Answer: it combines (<strong>c</strong>oncatenates) its arguments into a single vector. The first example creates a “character” (text data) and the second a “numeric” (numeric data).</p>
<div class="sourceCode" id="cb981"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="st">"a"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "1" "2" "a"</code></pre>
<div class="sourceCode" id="cb983"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="st">"a"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "character"</code></pre>
<div class="sourceCode" id="cb985"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 1 2 3</code></pre>
<div class="sourceCode" id="cb987"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "numeric"</code></pre>
<p><strong>D</strong></p>
<div class="sourceCode" id="cb989"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#install it. Note the quotes</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"RColorBrewer"</span><span class="op">)</span></span>
<span><span class="co">#load it into your session. Note the absence of quotes</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">RColorBrewer</span><span class="op">)</span></span></code></pre></div>
<p><strong>E</strong></p>
<div class="sourceCode" id="cb990"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">ceiling</a></span><span class="op">(</span><span class="va">numberz</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">trunc</a></span><span class="op">(</span><span class="va">numberz</span><span class="op">)</span> <span class="co"># or signif(numberz, 3)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">numberz</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">floor</a></span><span class="op">(</span><span class="va">numberz</span><span class="op">)</span></span></code></pre></div>
<p><strong>F</strong></p>
<div class="sourceCode" id="cb991"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="va">names</span>, <span class="st">" "</span><span class="op">)</span></span></code></pre></div>
<p><strong>G</strong></p>
<div class="sourceCode" id="cb992"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">birds</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="variables-2" class="section level3" number="19.3.3">
<h3>
<span class="header-section-number">19.3.3</span> Variables<a class="anchor" aria-label="anchor" href="#variables-2"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb993"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span></span>
<span><span class="va">x</span> <span class="op">+</span> <span class="va">y</span></span>
<span><span class="va">x</span><span class="op">^</span><span class="va">z</span></span>
<span><span class="co">#OR</span></span>
<span><span class="co">#x**z</span></span>
<span><span class="va">q</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">*</span> <span class="va">y</span> <span class="op">*</span> <span class="va">z</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">q</span><span class="op">)</span></span>
<span><span class="va">q</span><span class="op">/</span><span class="va">pi</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">x</span> <span class="op">*</span> <span class="va">y</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="vectors-2" class="section level3" number="19.3.4">
<h3>
<span class="header-section-number">19.3.4</span> Vectors<a class="anchor" aria-label="anchor" href="#vectors-2"><i class="fas fa-link"></i></a>
</h3>
<div id="circles-1" class="section level4 unnumbered">
<h4>Circles<a class="anchor" aria-label="anchor" href="#circles-1"><i class="fas fa-link"></i></a>
</h4>
<p>The circumference of a circle is <span class="math inline">\(2\pi\cdot r\)</span>, its surface <span class="math inline">\(4\pi \cdot r^2\)</span> and its volume <span class="math inline">\(4/3 \pi\cdot r^3\)</span>.
Given this vector of circle radiuses,</p>
<div class="sourceCode" id="cb994"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">radiuses</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="va">pi</span>, <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<p><strong>A</strong><br>
Calculate their cirumference.</p>
<div class="sourceCode" id="cb995"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">*</span> <span class="va">radiuses</span></span></code></pre></div>
<p><strong>B</strong><br>
Calculate their surface.</p>
<div class="sourceCode" id="cb996"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">4</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">*</span> <span class="va">radiuses</span><span class="op">^</span><span class="fl">2</span></span></code></pre></div>
<p><strong>C</strong><br>
Calculate their volume.</p>
<div class="sourceCode" id="cb997"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">4</span><span class="op">/</span><span class="fl">3</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">*</span> <span class="va">radiuses</span><span class="op">^</span><span class="fl">3</span></span></code></pre></div>
</div>
<div id="creating-vectors-2" class="section level4 unnumbered">
<h4>Creating vectors<a class="anchor" aria-label="anchor" href="#creating-vectors-2"><i class="fas fa-link"></i></a>
</h4>
<p>Create the following vectors, as efficiently as possible. The functions <code><a href="https://rdrr.io/r/base/rep.html">rep()</a></code>, <code><a href="https://rdrr.io/r/base/seq.html">seq()</a></code> and <code><a href="https://rdrr.io/r/base/paste.html">paste0()</a></code> and the colon operator <code>:</code> can be used, in any combination.</p>
<p><strong>A</strong><br><code>[1] 1 2 5 1 2 5</code></p>
<div class="sourceCode" id="cb998"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">5</span><span class="op">)</span>, times <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><strong>B</strong><br><code>[1] 9 9 9 8 8 8 7 7 7 6 6 6 5 5 5</code></p>
<div class="sourceCode" id="cb999"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">9</span><span class="op">:</span><span class="fl">5</span>, each <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><strong>C</strong><br><code>[1] 1 1 1 4 4 4 9 9 9 1 1 1 4 4 4 9 9 9</code></p>
<div class="sourceCode" id="cb1000"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">9</span><span class="op">)</span>, times <span class="op">=</span> <span class="fl">2</span>, each <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><strong>D</strong><br><code>[1] "1a" "2b" "3c" "4d" "5e" "1a" "2b" "3c" "4d" "5e"</code></p>
<div class="sourceCode" id="cb1001"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span>, times <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><strong>E</strong><br><code>[1] "0z"   "0.2y" "0.4x" "0.6w" "0.8v" "1u"</code></p>
<div class="sourceCode" id="cb1002"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>, <span class="va">letters</span><span class="op">[</span><span class="fl">26</span><span class="op">:</span><span class="fl">21</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><strong>F</strong><br><code>[1] "505" "404" "303" "202" "101" "000"</code></p>
<div class="sourceCode" id="cb1003"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="fl">5</span><span class="op">:</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">5</span><span class="op">:</span><span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p><strong>G [Challenge]</strong><br><code>[1] "0.5A5.0" "0.4B4.0" "0.3C3.0" "0.2D2.0" "0.1E1.0"</code></p>
<div class="sourceCode" id="cb1004"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0.5</span>, to <span class="op">=</span> <span class="fl">0.1</span>, by <span class="op">=</span> <span class="op">-</span><span class="fl">0.1</span><span class="op">)</span>,  <span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>, <span class="fl">5</span><span class="op">:</span><span class="fl">1</span>, <span class="st">".0"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
<div id="complex-datatypes-1" class="section level2" number="19.4">
<h2>
<span class="header-section-number">19.4</span> Complex datatypes<a class="anchor" aria-label="anchor" href="#complex-datatypes-1"><i class="fas fa-link"></i></a>
</h2>
<div id="creating-factors-1" class="section level3" number="19.4.1">
<h3>
<span class="header-section-number">19.4.1</span> Creating factors<a class="anchor" aria-label="anchor" href="#creating-factors-1"><i class="fas fa-link"></i></a>
</h3>
<p><strong>A</strong></p>
<div class="sourceCode" id="cb1005"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">animal_risk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">animal_risk_factor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">animal_risk</span>,</span>
<span>                             levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>                             labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"harmless"</span>, <span class="st">"risky"</span>, <span class="st">"dangerous"</span>, <span class="st">"deadly"</span><span class="op">)</span>,</span>
<span>                             ordered <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><strong>B</strong></p>
<div class="sourceCode" id="cb1006"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">wealth_male</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, </span>
<span>                 size <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>                 replace<span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                 prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.7</span>, <span class="fl">0.17</span>, <span class="fl">0.12</span>, <span class="fl">0.01</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">wealth_female</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, </span>
<span>                 size <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>                 replace<span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                 prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.15</span>, <span class="fl">0.497</span>, <span class="fl">0.003</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">wealth_labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"poor"</span>, <span class="st">"middle class"</span>, <span class="st">"wealthy"</span>, <span class="st">"rich"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">wealth_male_f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">wealth_male</span>,</span>
<span>                        levels <span class="op">=</span> <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>,</span>
<span>                        labels <span class="op">=</span> <span class="va">wealth_labels</span>,</span>
<span>                        ordered <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">wealth_female_f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">wealth_female</span>,</span>
<span>                        levels <span class="op">=</span> <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>,</span>
<span>                        labels <span class="op">=</span> <span class="va">wealth_labels</span>,</span>
<span>                        ordered <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#combine</span></span>
<span><span class="va">wealth_all_f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">wealth_male_f</span>, <span class="va">wealth_female_f</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/proportions.html">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">wealth_all_f</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span></code></pre></div>
<pre><code>## wealth_all_f
##         poor middle class      wealthy         rich 
##        63.65        12.45        23.35         0.55</code></pre>
</div>
<div id="list-actions-1" class="section level3" number="19.4.2">
<h3>
<span class="header-section-number">19.4.2</span> List actions<a class="anchor" aria-label="anchor" href="#list-actions-1"><i class="fas fa-link"></i></a>
</h3>
<p><strong>A</strong></p>
<div class="sourceCode" id="cb1008"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">house_admin</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></code></pre></div>
<p><strong>B</strong></p>
<div class="sourceCode" id="cb1009"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">house_admin</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="co">#OR</span></span>
<span><span class="va">house_admin</span><span class="op">$</span><span class="va">Rose</span></span></code></pre></div>
<p><strong>C</strong></p>
<div class="sourceCode" id="cb1010"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">house_admin</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span></span></code></pre></div>
<p><strong>D</strong></p>
<div class="sourceCode" id="cb1011"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">house_admin</span><span class="op">$</span><span class="va">Mike</span><span class="op">$</span><span class="va">cooking</span></span>
<span><span class="co">#OR</span></span>
<span><span class="va">house_admin</span><span class="op">$</span><span class="va">Mike</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#OR</span></span>
<span><span class="va">house_admin</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"cooking"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#MORE POSSIBILITIES</span></span></code></pre></div>
<p><strong>E</strong></p>
<div class="sourceCode" id="cb1012"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">house_admin</span><span class="op">$</span><span class="va">John</span><span class="op">$</span><span class="va">tasks</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="co">#MANY MORE POSSIBILITIES</span></span></code></pre></div>
</div>
<div id="named-vectors-1" class="section level3" number="19.4.3">
<h3>
<span class="header-section-number">19.4.3</span> Named vectors<a class="anchor" aria-label="anchor" href="#named-vectors-1"><i class="fas fa-link"></i></a>
</h3>
<p><strong>A</strong></p>
<div class="sourceCode" id="cb1013"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">codons</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"G"</span>, <span class="st">"P"</span>, <span class="st">"K"</span>, <span class="st">"S"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">codons</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"GGA"</span>, <span class="st">"CCU"</span>, <span class="st">"AAA"</span>, <span class="st">"AGU"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">my_DNA</span> <span class="op">&lt;-</span> <span class="st">"GGACCUAAAAGU"</span></span>
<span><span class="va">my_prot</span> <span class="op">&lt;-</span> <span class="st">""</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">1</span>, to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nchar.html">nchar</a></span><span class="op">(</span><span class="va">my_DNA</span><span class="op">)</span>, by <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">codon</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="va">my_DNA</span>, <span class="va">i</span>, <span class="va">i</span><span class="op">+</span><span class="fl">2</span><span class="op">)</span></span>
<span>        <span class="va">my_prot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">my_prot</span>, <span class="va">codons</span><span class="op">[</span><span class="va">codon</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_prot</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "GPKS"</code></pre>
<p><strong>B</strong></p>
<div class="sourceCode" id="cb1015"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nuc_weights</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">491.2</span>, <span class="fl">467.2</span>, <span class="fl">507.2</span>, <span class="fl">482.2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">nuc_weights</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'A'</span>, <span class="st">'C'</span>, <span class="st">'G'</span>, <span class="st">'U'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mol_weight</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nchar.html">nchar</a></span><span class="op">(</span><span class="va">my_DNA</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">nuc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="va">my_DNA</span>, <span class="va">i</span>, <span class="va">i</span><span class="op">)</span>;</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">nuc</span><span class="op">)</span></span>
<span>        <span class="va">mol_weight</span> <span class="op">&lt;-</span> <span class="va">mol_weight</span> <span class="op">+</span> <span class="va">nuc_weights</span><span class="op">[</span><span class="va">nuc</span><span class="op">]</span></span>
<span><span class="op">}</span></span>
<span><span class="va">mol_weight</span></span></code></pre></div>
</div>
<div id="lowry-1" class="section level3" number="19.4.4">
<h3>
<span class="header-section-number">19.4.4</span> Lowry<a class="anchor" aria-label="anchor" href="#lowry-1"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb1016"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bsa_conc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,    <span class="fl">0</span>,  <span class="fl">0.025</span>,  <span class="fl">0.025</span>,  <span class="fl">0.075</span>,  <span class="fl">0.075</span>,  <span class="fl">0.125</span>,  <span class="fl">0.125</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb1017"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">OD750</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.063</span>,   <span class="fl">0.033</span>,  <span class="fl">0.16</span>,   <span class="fl">0.181</span>,  <span class="fl">0.346</span>,  <span class="fl">0.352</span>,  <span class="fl">0.491</span>,  <span class="fl">0.488</span><span class="op">)</span></span></code></pre></div>
<p><strong>A</strong></p>
<div class="sourceCode" id="cb1018"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dilution</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">bsa_conc</span>, <span class="va">OD750</span><span class="op">)</span></span></code></pre></div>
<p><strong>B</strong></p>
<div class="sourceCode" id="cb1019"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">dilution</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"prot_conc"</span>, <span class="st">"absorption"</span><span class="op">)</span></span></code></pre></div>
<p><strong>C</strong></p>
<div class="sourceCode" id="cb1020"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bsa_conc2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.175</span>,   <span class="fl">0.175</span>,  <span class="fl">0.25</span>,   <span class="fl">0.25</span><span class="op">)</span></span>
<span><span class="va">OD750_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.597</span>, <span class="fl">0.595</span>,  <span class="fl">0.743</span>,  <span class="fl">0.742</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb1021"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="st">"prot_conc"</span> <span class="op">=</span> <span class="va">bsa_conc2</span>,</span>
<span>                      <span class="st">"absorption"</span> <span class="op">=</span> <span class="va">OD750_2</span><span class="op">)</span></span></code></pre></div>
<p><strong>D</strong></p>
<div class="sourceCode" id="cb1022"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dilution</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">dilution</span>, <span class="va">df_temp</span><span class="op">)</span></span></code></pre></div>
<p><strong>E</strong></p>
<div class="sourceCode" id="cb1023"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">even</span> <span class="op">&lt;-</span> <span class="va">dilution</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">T</span>, <span class="cn">F</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">odd</span> <span class="op">&lt;-</span> <span class="va">dilution</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">F</span>, <span class="cn">T</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">dilution_duplo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">odd</span>, <span class="va">even</span><span class="op">)</span></span>
<span><span class="va">dilution_duplo</span></span></code></pre></div>
<p><strong>F</strong></p>
<div class="sourceCode" id="cb1024"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dilution_duplo</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">dilution_duplo</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"prot_conc"</span>, <span class="st">"abs1"</span>, <span class="st">"abs2"</span><span class="op">)</span></span>
<span><span class="va">dilution_duplo</span></span></code></pre></div>
<p><strong>G</strong></p>
<p><code>{rlowry-duplo-mean-a, eval = FALSE} dilution_duplo$mean &lt;- (dilution_duplo$abs1 + dilution_duplo$abs2) / 2 dilution_duplo</code></p>
</div>
<div id="island-surfaces-1" class="section level3" number="19.4.5">
<h3>
<span class="header-section-number">19.4.5</span> Island surfaces<a class="anchor" aria-label="anchor" href="#island-surfaces-1"><i class="fas fa-link"></i></a>
</h3>
<p><strong>A</strong></p>
<div class="sourceCode" id="cb1025"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">islands_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Island <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">islands</span><span class="op">)</span>,</span>
<span>                        Area <span class="op">=</span> <span class="va">islands</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">islands_df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">islands_df</span></span></code></pre></div>
<p><strong>B</strong></p>
<div class="sourceCode" id="cb1026"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">islands_df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">islands_df</span><span class="op">$</span><span class="va">Area</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, <span class="op">]</span></span>
<span><span class="co">#OR</span></span>
<span><span class="va">islands_df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">islands_df</span><span class="op">$</span><span class="va">Area</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="op">]</span></span></code></pre></div>
</div>
<div id="usarrests-1" class="section level3" number="19.4.6">
<h3>
<span class="header-section-number">19.4.6</span> USArrests<a class="anchor" aria-label="anchor" href="#usarrests-1"><i class="fas fa-link"></i></a>
</h3>
<p>The <code>USArrests</code> dataset is also one of the datasets included in the <code>datasets</code> package. It has info on the fifty states for these variables:</p>
<pre><code>Murder arrests (per 100,000)
Assault arrests (per 100,000)
UrbanPop Percent urban population
Rape arrests (per 100,000)</code></pre>
<p>We’ll explore this dataset for a few questions.</p>
<p><strong>A</strong></p>
<div class="sourceCode" id="cb1028"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">USArrests</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">USArrests</span><span class="op">)</span> <span class="op">==</span> <span class="st">"Montana"</span>, <span class="op">]</span></span></code></pre></div>
<p><strong>B</strong></p>
<div class="sourceCode" id="cb1029"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">USArrests</span><span class="op">[</span><span class="va">USArrests</span><span class="op">$</span><span class="va">Rape</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">USArrests</span><span class="op">$</span><span class="va">Rape</span><span class="op">)</span>, <span class="op">]</span></span></code></pre></div>
<p><strong>C</strong></p>
<div class="sourceCode" id="cb1030"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">USArrests</span><span class="op">[</span><span class="va">USArrests</span><span class="op">$</span><span class="va">Assault</span> <span class="op">&lt;</span> <span class="va">USArrests</span><span class="op">$</span><span class="va">Murder</span> <span class="op">*</span> <span class="fl">10</span>, <span class="op">]</span></span></code></pre></div>
</div>
<div id="file-reading-practice-1" class="section level3" number="19.4.7">
<h3>
<span class="header-section-number">19.4.7</span> File reading practice<a class="anchor" aria-label="anchor" href="#file-reading-practice-1"><i class="fas fa-link"></i></a>
</h3>
<p><strong>File 01</strong></p>
<div class="sourceCode" id="cb1031"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_dir</span> <span class="op">&lt;-</span> <span class="st">"data/file_reading"</span></span>
<span><span class="va">my_file</span> <span class="op">&lt;-</span> <span class="st">"file01.txt"</span></span>
<span><span class="va">my_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">my_dir</span>, <span class="st">"/"</span>, <span class="va">my_file</span><span class="op">)</span></span>
<span><span class="va">my_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span></span>
<span>    <span class="va">my_path</span>,</span>
<span>    comment.char <span class="op">=</span> <span class="st">"#"</span>,</span>
<span>    header <span class="op">=</span> <span class="cn">T</span>,</span>
<span>    sep <span class="op">=</span> <span class="st">","</span>,</span>
<span>    dec <span class="op">=</span> <span class="st">"."</span>,</span>
<span>    na.strings <span class="op">=</span> <span class="st">"ND"</span>,</span>
<span>    as.is <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><strong>File 02</strong></p>
<div class="sourceCode" id="cb1032"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_file</span> <span class="op">&lt;-</span> <span class="st">"file02.txt"</span></span>
<span><span class="va">my_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">my_dir</span>, <span class="st">"/"</span>, <span class="va">my_file</span><span class="op">)</span></span>
<span><span class="va">my_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span></span>
<span>    <span class="va">my_path</span>,</span>
<span>    comment.char <span class="op">=</span> <span class="st">"$"</span>,</span>
<span>    header <span class="op">=</span> <span class="cn">T</span>,</span>
<span>    sep <span class="op">=</span> <span class="st">"\t"</span>,</span>
<span>    dec <span class="op">=</span> <span class="st">","</span>,</span>
<span>    na.strings <span class="op">=</span> <span class="st">"?"</span>,</span>
<span>    as.is <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong>File 03</strong></p>
<div class="sourceCode" id="cb1033"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_file</span> <span class="op">&lt;-</span> <span class="st">"file03.txt"</span></span>
<span><span class="va">my_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">my_dir</span>, <span class="st">"/"</span>, <span class="va">my_file</span><span class="op">)</span></span>
<span><span class="va">my_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span></span>
<span>    <span class="va">my_path</span>,</span>
<span>    header <span class="op">=</span> <span class="cn">T</span>,</span>
<span>    sep <span class="op">=</span> <span class="st">";"</span>,</span>
<span>    dec <span class="op">=</span> <span class="st">"."</span>,</span>
<span>    na.strings <span class="op">=</span> <span class="st">"ND"</span>,</span>
<span>    as.is <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong>File 04</strong></p>
<div class="sourceCode" id="cb1034"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_file</span> <span class="op">&lt;-</span> <span class="st">"file04.txt"</span></span>
<span><span class="va">my_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">my_dir</span>, <span class="st">"/"</span>, <span class="va">my_file</span><span class="op">)</span></span>
<span><span class="va">my_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span></span>
<span>    <span class="va">my_path</span>,</span>
<span>    header <span class="op">=</span> <span class="cn">T</span>,</span>
<span>    sep <span class="op">=</span> <span class="st">"\t"</span>,</span>
<span>    dec <span class="op">=</span> <span class="st">","</span>,</span>
<span>    na.strings <span class="op">=</span> <span class="st">"no data"</span>,</span>
<span>    as.is <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong>File 05</strong></p>
<div class="sourceCode" id="cb1035"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_file</span> <span class="op">&lt;-</span> <span class="st">"file05.txt"</span></span>
<span><span class="va">my_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">my_dir</span>, <span class="st">"/"</span>, <span class="va">my_file</span><span class="op">)</span></span>
<span><span class="va">my_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span></span>
<span>    <span class="va">my_path</span>,</span>
<span>    comment.char <span class="op">=</span> <span class="st">"#"</span>,</span>
<span>    header <span class="op">=</span> <span class="cn">T</span>,</span>
<span>    sep <span class="op">=</span> <span class="st">";"</span>,</span>
<span>    dec <span class="op">=</span> <span class="st">"."</span>,</span>
<span>    na.strings <span class="op">=</span> <span class="st">"ND"</span>,</span>
<span>    as.is <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong>File 06</strong></p>
<div class="sourceCode" id="cb1036"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_file</span> <span class="op">&lt;-</span> <span class="st">"file06.txt"</span></span>
<span><span class="va">my_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">my_dir</span>, <span class="st">"/"</span>, <span class="va">my_file</span><span class="op">)</span></span>
<span><span class="va">my_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span></span>
<span>    <span class="va">my_path</span>,</span>
<span>    comment.char <span class="op">=</span> <span class="st">"#"</span>,</span>
<span>    header <span class="op">=</span> <span class="cn">T</span>,</span>
<span>    sep <span class="op">=</span> <span class="st">","</span>,</span>
<span>    dec <span class="op">=</span> <span class="st">"."</span>,</span>
<span>    na.strings <span class="op">=</span> <span class="st">"-"</span>,</span>
<span>    as.is <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">my_data</span></span></code></pre></div>
<p><strong>File 07</strong></p>
<div class="sourceCode" id="cb1037"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_file</span> <span class="op">&lt;-</span> <span class="st">"file07.txt"</span></span>
<span><span class="va">my_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">my_dir</span>, <span class="st">"/"</span>, <span class="va">my_file</span><span class="op">)</span></span>
<span><span class="va">my_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span></span>
<span>    <span class="va">my_path</span>,</span>
<span>    comment.char <span class="op">=</span> <span class="st">"#"</span>,</span>
<span>    header <span class="op">=</span> <span class="cn">F</span>,</span>
<span>    sep <span class="op">=</span> <span class="st">";"</span>,</span>
<span>    dec <span class="op">=</span> <span class="st">"."</span>,</span>
<span>    na.strings <span class="op">=</span> <span class="st">"-"</span>,</span>
<span>    as.is <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><strong>File 08</strong></p>
<div class="sourceCode" id="cb1038"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_file</span> <span class="op">&lt;-</span> <span class="st">"file08.txt"</span></span>
<span><span class="va">my_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">my_dir</span>, <span class="st">"/"</span>, <span class="va">my_file</span><span class="op">)</span></span>
<span><span class="va">my_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span></span>
<span>    <span class="va">my_path</span>,</span>
<span>    comment.char <span class="op">=</span> <span class="st">"@"</span>,</span>
<span>    header <span class="op">=</span> <span class="cn">T</span>,</span>
<span>    sep <span class="op">=</span> <span class="st">";"</span>,</span>
<span>    dec <span class="op">=</span> <span class="st">"."</span>,</span>
<span>    na.strings <span class="op">=</span> <span class="st">"ND"</span>,</span>
<span>    as.is <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>(More files, but solutions omitted.)</p>
</div>
</div>
<div id="basics-of-the-ggplot2-package-1" class="section level2" number="19.5">
<h2>
<span class="header-section-number">19.5</span> Basics of the <code>ggplot2</code> package<a class="anchor" aria-label="anchor" href="#basics-of-the-ggplot2-package-1"><i class="fas fa-link"></i></a>
</h2>
<div id="trees-1" class="section level3" number="19.5.1">
<h3>
<span class="header-section-number">19.5.1</span> Trees<a class="anchor" aria-label="anchor" href="#trees-1"><i class="fas fa-link"></i></a>
</h3>
<p>With the <code>trees</code> dataset from the datasets package, create a scatter plot according to these constraints.</p>
<ul>
<li>x-axis: Height</li>
<li>y-axis: Girth</li>
<li>size of plot symbol: Volume</li>
<li>color of plot symbol: darkgreen</li>
<li>a smoother without error margins</li>
</ul>
<p>NB: Where you specify aesthetics matters here!</p>
<p>As extra practice you could convert the values to the metric system first.</p>
<div class="sourceCode" id="cb1039"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">trees</span>,</span>
<span>       mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Height</span>, y <span class="op">=</span> <span class="va">Girth</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>size <span class="op">=</span> <span class="va">Volume</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"darkgreen"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"loess"</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, formula <span class="op">=</span> <span class="va">y</span><span class="op">~</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Height (ft)"</span>, y <span class="op">=</span> <span class="st">"Girth (inches)"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="DAVuR_files/figure-html/trees-plot-a-1.png" width="672"></div>
</div>
<div id="insect-sprays-1" class="section level3" number="19.5.2">
<h3>
<span class="header-section-number">19.5.2</span> Insect Sprays<a class="anchor" aria-label="anchor" href="#insect-sprays-1"><i class="fas fa-link"></i></a>
</h3>
<p>The <code>datasets</code> package that is shipped with R has a dataset called <code>?</code>. Type <code><a href="https://rdrr.io/r/datasets/InsectSprays.html">?InsectSprays</a></code> to get information on it.</p>
<p><strong>A [❋]</strong></p>
<div class="sourceCode" id="cb1040"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">InsectSprays</span>, </span>
<span>       mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">spray</span>, y <span class="op">=</span> <span class="va">count</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Insect count"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Insect spray"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:insect-sprays-A"></span>
<img src="DAVuR_files/figure-html/insect-sprays-A-1.png" alt="The counts of insects in agricultural experimental units treated with different insecticides" width="80%"><p class="caption">
Figure 19.1: The counts of insects in agricultural experimental units treated with different insecticides
</p>
</div>
<p><strong>B [❋❋]</strong></p>
<div class="sourceCode" id="cb1041"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">InsectSprays</span>, </span>
<span>       mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">spray</span>, y <span class="op">=</span> <span class="va">count</span>, color <span class="op">=</span> <span class="va">spray</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">0</span>, width <span class="op">=</span> <span class="fl">0.1</span>, shape <span class="op">=</span> <span class="fl">18</span>, size <span class="op">=</span> <span class="fl">2</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Insect count"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Insect spray"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:insect-sprays-B"></span>
<img src="DAVuR_files/figure-html/insect-sprays-B-1.png" alt="The counts of insects in agricultural experimental units treated with different insecticides" width="80%"><p class="caption">
Figure 19.2: The counts of insects in agricultural experimental units treated with different insecticides
</p>
</div>
</div>
<div id="pharmacokinetics-1" class="section level3" number="19.5.3">
<h3>
<span class="header-section-number">19.5.3</span> Pharmacokinetics<a class="anchor" aria-label="anchor" href="#pharmacokinetics-1"><i class="fas fa-link"></i></a>
</h3>
<p>The <code>Theoph</code> dataset contains pharmacokinetics of theophylline, the anti-asthmatic drug theophylline. Twelve subjects were given oral doses of theophylline, then serum concentrations were measured at 11 time points over the next 25 hours.</p>
<p><strong>A</strong></p>
<div class="sourceCode" id="cb1042"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">Theoph</span>,</span>
<span>       mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">conc</span>, color <span class="op">=</span> <span class="va">Dose</span>, linetype <span class="op">=</span> <span class="va">Subject</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Time (h)"</span>, y <span class="op">=</span> <span class="st">"Concentration (mg/l)"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="DAVuR_files/figure-html/theoph-decay-1-1.png" width="672"></div>
<p><strong>B</strong></p>
<div class="sourceCode" id="cb1043"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">Theoph</span>,</span>
<span>       mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">conc</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>group <span class="op">=</span> <span class="va">Subject</span>, color <span class="op">=</span> <span class="va">Dose</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_color_gradient</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"green"</span>, high <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Time (h)"</span>, y <span class="op">=</span> <span class="st">"Concentration (mg/l)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="DAVuR_files/figure-html/theoph-decay-2-1.png" width="672"></div>
<p>(Many more solutions possible)</p>
</div>
<div id="usarrests-ii-1" class="section level3" number="19.5.4">
<h3>
<span class="header-section-number">19.5.4</span> USArrests (II)<a class="anchor" aria-label="anchor" href="#usarrests-ii-1"><i class="fas fa-link"></i></a>
</h3>
<p><strong>A</strong></p>
<div class="sourceCode" id="cb1044"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">USArrests</span>,</span>
<span>       mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Assault</span>,</span>
<span>                     y <span class="op">=</span> <span class="va">Murder</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"darkgreen"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, formula <span class="op">=</span> <span class="va">y</span><span class="op">~</span><span class="va">x</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, color <span class="op">=</span> <span class="st">"darkred"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Assault arrests (per 100,000)"</span>, y <span class="op">=</span> <span class="st">"Murder arrests (per 100,000)"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="DAVuR_files/figure-html/ggplot-usarrests-scatter-a-1.png" width="672"></div>
<p><strong>B</strong></p>
<div class="sourceCode" id="cb1045"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scale</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">USArrests</span>,</span>
<span>       mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Assault</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">..density..</span><span class="op">)</span>, fill <span class="op">=</span> <span class="st">"lightblue"</span>, color <span class="op">=</span> <span class="st">"black"</span>, bins <span class="op">=</span> <span class="fl">30</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"darkblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">#scale_y_continuous(sec.axis = sec_axis(~ . * scale, name="Assault prob")) +</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Assault arrests (per 100,000)"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Warning: The dot-dot notation (`..density..`) was deprecated in ggplot2 3.4.0.
## ℹ Please use `after_stat(density)` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was generated.</code></pre>
<div class="inline-figure"><img src="DAVuR_files/figure-html/ggplot-usarrests-hist-dens-a-1.png" width="672"></div>
</div>
<div id="orchard-sprays-1" class="section level3" number="19.5.5">
<h3>
<span class="header-section-number">19.5.5</span> Orchard Sprays<a class="anchor" aria-label="anchor" href="#orchard-sprays-1"><i class="fas fa-link"></i></a>
</h3>
<p><strong>A</strong></p>
<div class="sourceCode" id="cb1047"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">OrchardSprays</span>,</span>
<span>       mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">treatment</span>, y <span class="op">=</span> <span class="va">decrease</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"darkred"</span>, width <span class="op">=</span> <span class="fl">0.2</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="DAVuR_files/figure-html/orchard-sprays-1-a-1.png" width="672"></div>
<p><strong>B</strong></p>
<div class="sourceCode" id="cb1048"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">OrchardSprays</span>,</span>
<span>       mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">treatment</span>, y <span class="op">=</span> <span class="va">decrease</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html">geom_violin</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill<span class="op">=</span><span class="va">treatment</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="DAVuR_files/figure-html/orchard-sprays-2-a-1.png" width="672"></div>
</div>
<div id="diauxic-growth-1" class="section level3" number="19.5.6">
<h3>
<span class="header-section-number">19.5.6</span> Diauxic growth<a class="anchor" aria-label="anchor" href="#diauxic-growth-1"><i class="fas fa-link"></i></a>
</h3>
<p><strong>A [❋❋]</strong></p>
<div class="sourceCode" id="cb1049"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">remote</span> <span class="op">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/MichielNoback/datasets/master/diauxic_growth/monod_diauxic_growth.csv"</span></span>
<span><span class="co">#local &lt;- "../diauxic.csv"</span></span>
<span><span class="co">#download.file(url = remote, destfile = local)</span></span>
<span><span class="va">diauxic</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="va">remote</span>, sep <span class="op">=</span> <span class="st">";"</span>, header <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="va">diauxic</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">diauxic</span>,</span>
<span>                        cols <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,</span>
<span>                        names_to <span class="op">=</span> <span class="st">"Substrate"</span>,</span>
<span>                        values_to <span class="op">=</span> <span class="st">"OD"</span><span class="op">)</span></span></code></pre></div>
<p><strong>B [❋]</strong></p>
<div class="sourceCode" id="cb1050"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">diauxic</span><span class="op">$</span><span class="va">Substrate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">diauxic</span><span class="op">$</span><span class="va">Substrate</span>, </span>
<span>       levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"GlucMann"</span>, <span class="st">"GlucXyl"</span>, <span class="st">"GlucArab"</span>, <span class="st">"GlucRham"</span><span class="op">)</span>, </span>
<span>       labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Glucose Mannose"</span>, <span class="st">"Glucose Xylose"</span>, <span class="st">"Glucose Arabinose"</span>, <span class="st">"Glucose Rhamnose"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><strong>C [❋❋]</strong></p>
<p>Create a line plot with all four growth curves within a single graph.</p>
<div class="sourceCode" id="cb1051"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">diauxic</span>,</span>
<span>       mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">OD</span>, color <span class="op">=</span> <span class="va">Substrate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">stat_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"loess"</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, span <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = 'y ~ x'</code></pre>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:diauxic-growth-C"></span>
<img src="DAVuR_files/figure-html/diauxic-growth-C-1.png" alt="Monod's Diauxic shift experiment." width="80%"><p class="caption">
Figure 19.3: Monod’s Diauxic shift experiment.
</p>
</div>
<p><strong>D [❋❋❋]</strong></p>
<div class="sourceCode" id="cb1053"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">diauxic</span>,</span>
<span>       mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">OD</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">stat_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"loess"</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, span <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="va">.</span> <span class="op">~</span> <span class="va">Substrate</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = 'y ~ x'</code></pre>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:diauxic-growth-D"></span>
<img src="DAVuR_files/figure-html/diauxic-growth-D-1.png" alt="Monod's Diauxic shift experiment." width="80%"><p class="caption">
Figure 19.4: Monod’s Diauxic shift experiment.
</p>
</div>
</div>
<div id="virginia-death-rates-1" class="section level3" number="19.5.7">
<h3>
<span class="header-section-number">19.5.7</span> Virginia Death Rates<a class="anchor" aria-label="anchor" href="#virginia-death-rates-1"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb1055"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">## %&gt;% is used to pipe results from one operation to the other, just like '|' in Linux.</span></span>
<span><span class="va">virginia_death_rates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="va">VADeaths</span><span class="op">)</span></span>
<span><span class="va">virginia_death_rates</span> <span class="op">&lt;-</span> <span class="va">virginia_death_rates</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="st">"Age Group"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">virginia_death_rates</span><span class="op">)</span>, ordered <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">`Age Group`</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co">#reorder the columns</span></span></code></pre></div>
<p><strong>A (❋❋❋)</strong></p>
<p>Pivot this table to long (tidy) format. This should generate a dataframe with four columns: <code>Age Group</code>, <code>Habitat</code>, <code>Gender</code> and <code>DeathRate</code>.</p>
<div class="sourceCode" id="cb1056"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">virginia_death_rates</span> <span class="op">&lt;-</span> <span class="va">virginia_death_rates</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, </span>
<span>                 names_to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Habitat"</span>, <span class="st">"Gender"</span><span class="op">)</span>, </span>
<span>                 names_sep <span class="op">=</span> <span class="st">" "</span>, </span>
<span>                 values_to <span class="op">=</span> <span class="st">"DeathRate"</span><span class="op">)</span></span></code></pre></div>
<p><strong>B (❋❋)</strong></p>
<div class="sourceCode" id="cb1057"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">virginia_death_rates</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">Gender</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>weight <span class="op">=</span> <span class="va">DeathRate</span>, fill <span class="op">=</span> <span class="va">Habitat</span><span class="op">)</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:VADeaths-B"></span>
<img src="DAVuR_files/figure-html/VADeaths-B-1.png" alt="Virginia Death rates" width="70%"><p class="caption">
Figure 19.5: Virginia Death rates
</p>
</div>
</div>
<div id="global-temperature-1" class="section level3" number="19.5.8">
<h3>
<span class="header-section-number">19.5.8</span> Global temperature<a class="anchor" aria-label="anchor" href="#global-temperature-1"><i class="fas fa-link"></i></a>
</h3>
<p>Load the data.</p>
<div class="sourceCode" id="cb1058"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">remote_file</span> <span class="op">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/MichielNoback/datasets/master/global_temperature/annual.csv"</span></span>
<span><span class="va">global_temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="va">remote_file</span>,</span>
<span>                          header <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                          sep <span class="op">=</span> <span class="st">","</span><span class="op">)</span></span></code></pre></div>
<div id="create-a-scatter-and-line-plot-1" class="section level4" number="19.5.8.1">
<h4>
<span class="header-section-number">19.5.8.1</span> Create a scatter-and-line-plot [❋❋]<a class="anchor" aria-label="anchor" href="#create-a-scatter-and-line-plot-1"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb1059"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">global_temp</span>,</span>
<span>       mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Year</span>, y <span class="op">=</span> <span class="va">Mean</span>, color <span class="op">=</span> <span class="va">Source</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>se <span class="op">=</span> <span class="cn">FALSE</span>, method <span class="op">=</span> <span class="st">"loess"</span>, formula <span class="op">=</span> <span class="st">'y ~ x'</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:scatter-global-temp"></span>
<img src="DAVuR_files/figure-html/scatter-global-temp-1.png" alt="Global temperature anomalies" width="80%"><p class="caption">
Figure 19.6: Global temperature anomalies
</p>
</div>
</div>
<div id="re-create-the-heatmap-1" class="section level4" number="19.5.8.2">
<h4>
<span class="header-section-number">19.5.8.2</span> Re-create the heatmap [❋❋❋]<a class="anchor" aria-label="anchor" href="#re-create-the-heatmap-1"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb1060"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">global_temp</span><span class="op">[</span><span class="va">global_temp</span><span class="op">$</span><span class="va">Source</span> <span class="op">==</span> <span class="st">"GCAG"</span>, <span class="op">]</span>,</span>
<span>       mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Year</span>, y <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_tile</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">Mean</span><span class="op">)</span>, colour <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradient2</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"blue"</span>, mid <span class="op">=</span> <span class="st">"white"</span>, high <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>, axis.ticks.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>, axis.title.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:heatmap-global-temp"></span>
<img src="DAVuR_files/figure-html/heatmap-global-temp-1.png" alt="Global temperature anomalies" width="80%"><p class="caption">
Figure 19.7: Global temperature anomalies
</p>
</div>
<p>Note: rescaling the temperature from 0 to 1 may yield even better results.</p>
</div>
<div id="extra-practice-1" class="section level4" number="19.5.8.3">
<h4>
<span class="header-section-number">19.5.8.3</span> Extra practice<a class="anchor" aria-label="anchor" href="#extra-practice-1"><i class="fas fa-link"></i></a>
</h4>
<p><strong>Level: [❋❋]</strong></p>
<p>No solutions for this one.</p>
</div>
</div>
<div id="investigate-new-visualization-1" class="section level3" number="19.5.9">
<h3>
<span class="header-section-number">19.5.9</span> Investigate new visualization<a class="anchor" aria-label="anchor" href="#investigate-new-visualization-1"><i class="fas fa-link"></i></a>
</h3>
<p>**Level: ❋❋</p>
<p>This assignment has no solution of course. It is included here solely to keep the numbering consistent for both assignment chapters.</p>
</div>
</div>
<div id="functions-ii-1" class="section level2" number="19.6">
<h2>
<span class="header-section-number">19.6</span> Functions (II)<a class="anchor" aria-label="anchor" href="#functions-ii-1"><i class="fas fa-link"></i></a>
</h2>
<div id="cut-1" class="section level3" number="19.6.1">
<h3>
<span class="header-section-number">19.6.1</span> <code>cut()</code><a class="anchor" aria-label="anchor" href="#cut-1"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb1061"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">USArrests</span><span class="op">$</span><span class="va">UrbanPop_f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span><span class="op">(</span><span class="va">USArrests</span><span class="op">$</span><span class="va">UrbanPop</span>, </span>
<span>                  breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">60</span>, <span class="fl">80</span>, <span class="fl">100</span><span class="op">)</span>,</span>
<span>                  labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"low"</span>, <span class="st">"mid"</span>, <span class="st">"high"</span><span class="op">)</span>,</span>
<span>                  right <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">USArrests</span><span class="op">$</span><span class="va">UrbanPop_f</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="quantile-1" class="section level3" number="19.6.2">
<h3>
<span class="header-section-number">19.6.2</span> <code>quantile()</code><a class="anchor" aria-label="anchor" href="#quantile-1"><i class="fas fa-link"></i></a>
</h3>
<p><strong>A</strong></p>
<div class="sourceCode" id="cb1062"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">precip</span><span class="op">[</span><span class="va">precip</span> <span class="op">&lt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">precip</span>, probs <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<pre><code>##     Phoenix Los Angeles      Denver       Boise        Reno Albuquerque 
##         7.0        14.0        13.0        11.5         7.2         7.8 
##     El Paso 
##         7.8</code></pre>
<p><strong>B</strong></p>
<div class="sourceCode" id="cb1064"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sel_range</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">infert</span><span class="op">$</span><span class="va">age</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">0.6</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">infert</span><span class="op">[</span><span class="va">infert</span><span class="op">$</span><span class="va">age</span> <span class="op">&gt;</span> <span class="va">sel_range</span><span class="op">[</span><span class="st">"40%"</span><span class="op">]</span> <span class="op">&amp;</span> <span class="va">infert</span><span class="op">$</span><span class="va">age</span> <span class="op">&lt;</span> <span class="va">sel_range</span><span class="op">[</span><span class="st">"60%"</span><span class="op">]</span>, <span class="op">]</span></span></code></pre></div>
</div>
</div>
<div id="flow-control-and-scripting-2" class="section level2" number="19.7">
<h2>
<span class="header-section-number">19.7</span> Flow control and scripting<a class="anchor" aria-label="anchor" href="#flow-control-and-scripting-2"><i class="fas fa-link"></i></a>
</h2>
<div id="illegal-reproductions-1" class="section level3" number="19.7.1">
<h3>
<span class="header-section-number">19.7.1</span> Illegal reproductions<a class="anchor" aria-label="anchor" href="#illegal-reproductions-1"><i class="fas fa-link"></i></a>
</h3>
<div id="the-mean-1" class="section level4 unnumbered">
<h4>The mean<a class="anchor" aria-label="anchor" href="#the-mean-1"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb1065"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_mean</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div id="standard-deviation-1" class="section level4 unnumbered">
<h4>Standard deviation<a class="anchor" aria-label="anchor" href="#standard-deviation-1"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb1066"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_sd</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div id="maximum-1" class="section level4 unnumbered">
<h4>Maximum<a class="anchor" aria-label="anchor" href="#maximum-1"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb1067"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span> </span>
<span><span class="va">my_nums</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">10000</span>, <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="va">my_max</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">max_val</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">my_nums</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="va">i</span> <span class="op">&gt;</span> <span class="va">max_val</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="va">max_val</span> <span class="op">=</span> <span class="va">i</span></span>
<span>        <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">max_val</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div id="median-1" class="section level4 unnumbered">
<h4>Median<a class="anchor" aria-label="anchor" href="#median-1"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb1068"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_median</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">sorted</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>        <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html">%%</a></span> <span class="fl">2</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>                <span class="co">#uneven length</span></span>
<span>                <span class="va">my_median</span> <span class="op">&lt;-</span> <span class="va">sorted</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">ceiling</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">]</span></span>
<span>        <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>                <span class="va">my_median</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">sorted</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="va">sorted</span><span class="op">[</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span></span>
<span>        <span class="op">}</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">my_median</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
</div>
<div id="various-other-functions-1" class="section level3" number="19.7.2">
<h3>
<span class="header-section-number">19.7.2</span> Various other functions<a class="anchor" aria-label="anchor" href="#various-other-functions-1"><i class="fas fa-link"></i></a>
</h3>
<div id="find-match-locations-1" class="section level4 unnumbered">
<h4>Find match locations<a class="anchor" aria-label="anchor" href="#find-match-locations-1"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb1069"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">where_is_it</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">look_for</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">found</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html">integer</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">elmnt</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="va">elmnt</span> <span class="op">==</span> <span class="va">look_for</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="va">found</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">found</span>, <span class="va">i</span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">found</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Pro"</span>, <span class="st">"Glu"</span>, <span class="st">"Lys"</span>, <span class="st">"Pro"</span>, <span class="st">"Ser"</span><span class="op">)</span></span>
<span><span class="fu">where_is_it</span><span class="op">(</span><span class="va">x</span>, <span class="st">"Pro"</span><span class="op">)</span></span>
<span><span class="co">##expected:</span></span>
<span><span class="co">#[1] 1 4</span></span></code></pre></div>
</div>
<div id="odd-and-even-1" class="section level4 unnumbered">
<h4>Odd and even<a class="anchor" aria-label="anchor" href="#odd-and-even-1"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb1070"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">count_odd_even</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">evens</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">x</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html">%%</a></span> <span class="fl">2</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span></span>
<span>    <span class="va">odds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">x</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html">%%</a></span> <span class="fl">2</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="co">#OR, more efficient</span></span>
<span>    <span class="co">#odds &lt;- length(x) - evens</span></span>
<span>    <span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>even <span class="op">=</span> <span class="va">evens</span>, odd <span class="op">=</span> <span class="va">odds</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">count_odd_even</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="add-column-compared-to-mean-1" class="section level4 unnumbered">
<h4>Add column compared to mean<a class="anchor" aria-label="anchor" href="#add-column-compared-to-mean-1"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb1071"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">add_compared_to_mean</span> <span class="op">&lt;-</span> <span class="kw">function</span> <span class="op">(</span><span class="va">df</span>, <span class="va">name</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">is.data.frame</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/stop.html">stop</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"'"</span>, <span class="va">df</span>, <span class="st">"' is not a dataframe."</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="op">!</span> <span class="va">name</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/stop.html">stop</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"'"</span>, <span class="va">name</span>, <span class="st">"' is not an existing column."</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="op">!</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">is.numeric</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span>, <span class="va">name</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/stop.html">stop</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"'"</span>, <span class="va">name</span>, <span class="st">" is not a numeric column."</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="va">the_col</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span>, <span class="va">name</span><span class="op">]</span></span>
<span>    <span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">the_col</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">the_col</span><span class="op">)</span>, <span class="st">"greater"</span>, <span class="st">"less"</span><span class="op">)</span></span>
<span>    <span class="va">df</span><span class="op">$</span><span class="va">compared_to_mean</span> <span class="op">&lt;-</span> <span class="va">tmp</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">my_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span>, b <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">add_compared_to_mean</span><span class="op">(</span><span class="va">my_df</span>, <span class="st">"a"</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="interquantile-ranges-1" class="section level4 unnumbered">
<h4>Interquantile ranges<a class="anchor" aria-label="anchor" href="#interquantile-ranges-1"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb1072"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interquantile_range</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">lower</span> <span class="op">=</span> <span class="fl">0</span>, <span class="va">upper</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">is.numeric</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">|</span> </span>
<span>      <span class="op">!</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">is.numeric</a></span><span class="op">(</span><span class="va">lower</span><span class="op">)</span> <span class="op">|</span></span>
<span>      <span class="op">!</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">is.numeric</a></span><span class="op">(</span><span class="va">upper</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html">stop</a></span><span class="op">(</span><span class="st">"all three arguments should be numeric"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">lower_val</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">x</span>, probs <span class="op">=</span> <span class="va">lower</span><span class="op">)</span></span>
<span>  <span class="va">upper_val</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">x</span>, probs <span class="op">=</span> <span class="va">upper</span><span class="op">)</span></span>
<span>  <span class="va">tmp</span> <span class="op">&lt;-</span> <span class="va">upper_val</span> <span class="op">-</span> <span class="va">lower_val</span></span>
<span>  <span class="co">#a named vector is always nice, for acces but also for display purposes</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">lower</span><span class="op">*</span><span class="fl">100</span>, <span class="st">"-"</span>, <span class="va">upper</span><span class="op">*</span><span class="fl">100</span>, <span class="st">"%"</span><span class="op">)</span></span>
<span>  <span class="va">tmp</span></span>
<span><span class="op">}</span></span>
<span><span class="va">tst</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span></span>
<span><span class="fu">interquantile_range</span><span class="op">(</span><span class="va">tst</span><span class="op">)</span> <span class="co"># 0 to 1</span></span>
<span><span class="fu">interquantile_range</span><span class="op">(</span><span class="va">tst</span>, <span class="fl">0.25</span>, <span class="fl">0.75</span><span class="op">)</span> <span class="co"># custom</span></span>
<span><span class="co">#interquantile_range("foo") # error!</span></span></code></pre></div>
</div>
<div id="vector-distance-1" class="section level4 unnumbered">
<h4>Vector distance<a class="anchor" aria-label="anchor" href="#vector-distance-1"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb1073"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">distance</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">p</span>, <span class="va">q</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">is.numeric</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="op">|</span> <span class="op">!</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">is.numeric</a></span><span class="op">(</span><span class="va">q</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/stop.html">stop</a></span><span class="op">(</span><span class="st">"non-numeric vectors passed"</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="op">!=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">q</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/stop.html">stop</a></span><span class="op">(</span><span class="st">"vectors have unequal length"</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">p</span> <span class="op">-</span> <span class="va">q</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div id="other-distance-measures-1" class="section level4 unnumbered">
<h4>Other distance measures<a class="anchor" aria-label="anchor" href="#other-distance-measures-1"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb1074"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_distance</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">p</span>, <span class="va">q</span>, <span class="va">method</span> <span class="op">=</span> <span class="st">"euclidean"</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">is.numeric</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="op">&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">is.numeric</a></span><span class="op">(</span><span class="va">q</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html">stop</a></span><span class="op">(</span><span class="st">"One or both of the vectors is not numeric"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="op">!=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">q</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html">stop</a></span><span class="op">(</span><span class="st">"Vectors are not of equal length"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">method</span> <span class="op">==</span> <span class="st">"euclidean"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">p</span> <span class="op">-</span> <span class="va">q</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">method</span> <span class="op">==</span> <span class="st">"manhattan"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">p</span><span class="op">-</span><span class="va">q</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html">stop</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Method not found: "</span>, <span class="va">method</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">my_distance</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="gc-percentage-1" class="section level4 unnumbered">
<h4>G/C percentage<a class="anchor" aria-label="anchor" href="#gc-percentage-1"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb1075"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">GC_perc</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">seq</span>, <span class="va">strict</span> <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">seq</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">seq</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">seq.split</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="va">seq</span>, <span class="st">""</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">gc.count</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>  <span class="va">anom.count</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">n</span> <span class="kw">in</span> <span class="va">seq.split</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grep</a></span><span class="op">(</span><span class="st">"[GATUCgatuc]"</span>, <span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="va">n</span> <span class="op">==</span> <span class="st">"G"</span> <span class="op">||</span> <span class="va">n</span> <span class="op">==</span> <span class="st">"C"</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">gc.count</span> <span class="op">&lt;-</span> <span class="va">gc.count</span> <span class="op">+</span> <span class="fl">1</span></span>
<span>      <span class="op">}</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="va">strict</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/stop.html">stop</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Illegal character"</span>, <span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>        <span class="va">anom.count</span> <span class="op">&lt;-</span> <span class="va">anom.count</span> <span class="op">+</span> <span class="fl">1</span>     </span>
<span>      <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="co">##return perc</span></span>
<span>  <span class="co">##print(gc.count)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">anom.count</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">anom.perc</span> <span class="op">&lt;-</span> <span class="va">anom.count</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/nchar.html">nchar</a></span><span class="op">(</span><span class="va">seq</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/warning.html">warning</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Non-DNA characters have percentage of"</span>, <span class="va">anom.perc</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">gc.count</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/nchar.html">nchar</a></span><span class="op">(</span><span class="va">seq</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
</div>
</div>
<div id="tidying-dataframes-using-package-tidyr-1" class="section level2" number="19.8">
<h2>
<span class="header-section-number">19.8</span> Tidying dataframes using Package tidyr<a class="anchor" aria-label="anchor" href="#tidying-dataframes-using-package-tidyr-1"><i class="fas fa-link"></i></a>
</h2>
<div id="small-examples-1" class="section level3" number="19.8.1">
<h3>
<span class="header-section-number">19.8.1</span> Small examples<a class="anchor" aria-label="anchor" href="#small-examples-1"><i class="fas fa-link"></i></a>
</h3>
<p>The <a href="data/"><code>data</code></a> folder of this eBook contains three small csv files that need tidying. Read them from file and convert them into tidy format, with data columns as clean as possible (e.g. not “creatine_T0” but “T0”).</p>
<p><strong>A</strong></p>
<p>Tidy file <a href="data/untidy1.csv"><code>untidy1.csv</code></a>.</p>
<div class="sourceCode" id="cb1076"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">untidy1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="st">"data/untidy1.csv"</span>, </span>
<span>                      sep <span class="op">=</span> <span class="st">","</span>, </span>
<span>                      header <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">untidy1</span>,</span>
<span>            names_from <span class="op">=</span> <span class="va">type</span>,</span>
<span>            values_from <span class="op">=</span> <span class="va">value</span><span class="op">)</span></span></code></pre></div>
<p><strong>B</strong></p>
<p>Tidy file <a href="data/untidy2.csv"><code>untidy2.csv</code></a>.</p>
<div class="sourceCode" id="cb1077"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">untidy2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="st">"data/untidy2.csv"</span>, </span>
<span>                      sep <span class="op">=</span> <span class="st">","</span>, </span>
<span>                      header <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">untidy2</span>,</span>
<span>             cols <span class="op">=</span> <span class="op">-</span><span class="va">patient</span>,</span>
<span>             names_prefix <span class="op">=</span> <span class="st">"creatine_"</span>,</span>
<span>             names_to <span class="op">=</span> <span class="st">"timepoint"</span>,</span>
<span>             values_to <span class="op">=</span> <span class="st">"creatine"</span><span class="op">)</span></span></code></pre></div>
<p><strong>C</strong></p>
<p>Tidy file <a href="data/untidy3.csv"><code>untidy3.csv</code></a>.</p>
<div class="sourceCode" id="cb1078"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">untidy3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="st">"data/untidy3.csv"</span>, </span>
<span>                      sep <span class="op">=</span> <span class="st">";"</span>, </span>
<span>                      header <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">untidy3</span>,</span>
<span>             cols <span class="op">=</span> <span class="op">-</span><span class="va">species</span>,</span>
<span>             names_sep <span class="op">=</span> <span class="st">"_"</span>,</span>
<span>             <span class="co">#OR</span></span>
<span>             <span class="co">#names_pattern = "(leashed|unleashed)_(caged|free)",</span></span>
<span>             names_to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"leashed"</span>, <span class="st">"caged"</span><span class="op">)</span>,</span>
<span>             values_to <span class="op">=</span> <span class="st">"wellbeing"</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="lung-cancer-1" class="section level3" number="19.8.2">
<h3>
<span class="header-section-number">19.8.2</span> Lung cancer<a class="anchor" aria-label="anchor" href="#lung-cancer-1"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb1079"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lung_cancer_deaths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1974</span><span class="op">:</span><span class="fl">1979</span>, each <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>                     month <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">month.abb</span>, times <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>,</span>
<span>                     male <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span><span class="va">mdeaths</span><span class="op">)</span>,</span>
<span>                     female <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span><span class="va">fdeaths</span><span class="op">)</span>,</span>
<span>                     total <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span><span class="va">ldeaths</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><strong>A</strong></p>
<div class="sourceCode" id="cb1080"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lung_cancer_deaths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">lung_cancer_deaths</span>, </span>
<span>             cols <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fl">5</span>, </span>
<span>             names_to <span class="op">=</span> <span class="st">"type"</span>,</span>
<span>             values_to <span class="op">=</span> <span class="st">"count"</span><span class="op">)</span></span></code></pre></div>
<p><strong>B</strong></p>
<p>Prep:</p>
<div class="sourceCode" id="cb1081"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lung_cancer_deaths</span><span class="op">$</span><span class="va">date</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">lung_cancer_deaths</span><span class="op">$</span><span class="va">month</span>, <span class="va">lung_cancer_deaths</span><span class="op">$</span><span class="va">year</span>, <span class="fl">1</span>, sep<span class="op">=</span><span class="st">"/"</span><span class="op">)</span>,</span>
<span>        format <span class="op">=</span> <span class="st">"%b/%Y/%d"</span><span class="op">)</span></span></code></pre></div>
<p>Figure:</p>
<div class="sourceCode" id="cb1082"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">lung_cancer_deaths</span>,</span>
<span>       mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">count</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">type</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="DAVuR_files/figure-html/lung-deaths-line-plot-a-1.png" width="70%" style="display: block; margin: auto;"></div>
<p><strong>C</strong></p>
<div class="sourceCode" id="cb1083"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">lung_cancer_deaths</span>,</span>
<span>       mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">type</span>, y <span class="op">=</span> <span class="va">count</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill<span class="op">=</span><span class="va">type</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="DAVuR_files/figure-html/lung-deaths-boxplot-a-1.png" width="70%" style="display: block; margin: auto;"></div>
<p>ANSWER: You can see a single outlier in the <code>female</code> set. We can identify the year by finding out when this occurred:</p>
<div class="sourceCode" id="cb1084"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">maximum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">lung_cancer_deaths</span><span class="op">[</span><span class="va">lung_cancer_deaths</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"female"</span>, <span class="st">"count"</span><span class="op">]</span><span class="op">)</span> <span class="co">## 1141</span></span>
<span><span class="va">lung_cancer_deaths</span><span class="op">[</span><span class="va">lung_cancer_deaths</span><span class="op">$</span><span class="va">count</span> <span class="op">==</span> <span class="va">maximum</span>, <span class="op">]</span></span></code></pre></div>
<pre><code>## # A tibble: 1 × 5
##    year month type   count date      
##   &lt;int&gt; &lt;chr&gt; &lt;chr&gt;  &lt;int&gt; &lt;date&gt;    
## 1  1976 Feb   female  1141 1976-02-01</code></pre>
<p>So this was February 1976. A quick Google search turned up a pdf document “CDC Influenza Surveillance” that states</p>
<blockquote>
<p>“The 1975-1976 influenza season was noteworthy because of several events. a) An H3N2 influenza virus (A/Victoria/3/75), isolated first in April 1975, caused a wide- spread epidemic late in the influenza season in the United States. Based on pneumonia- and influenza-associated mortality which peaked in February and March 1976, this was the most severe epidemic experienced by the United States since the 1968-1969 Hong Kong epidemic.”</p>
</blockquote>
<p>(<a href="https://stacks.cdc.gov/view/cdc/287/cdc_287_DS1.pdf">direct link</a>)</p>
<p>As you may know, (lung) cancer patients are especially vulnerable for influenza infections.</p>
</div>
</div>
<div id="old-school-data-mangling-1" class="section level2" number="19.9">
<h2>
<span class="header-section-number">19.9</span> Old school data mangling<a class="anchor" aria-label="anchor" href="#old-school-data-mangling-1"><i class="fas fa-link"></i></a>
</h2>
<div id="whale-selenium-1" class="section level3" number="19.9.1">
<h3>
<span class="header-section-number">19.9.1</span> Whale selenium<a class="anchor" aria-label="anchor" href="#whale-selenium-1"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb1086"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">whale_sel_url</span> <span class="op">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/MichielNoback/davur1/gh-pages/exercises/data/whale_selenium.txt"</span></span>
<span><span class="va">whale_selenium</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="va">whale_sel_url</span>,</span>
<span>        header <span class="op">=</span> <span class="cn">T</span>,</span>
<span>        row.names <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><strong>A</strong></p>
<div class="sourceCode" id="cb1087"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">whale_selenium</span>, MARGIN <span class="op">=</span> <span class="fl">2</span>, FUN <span class="op">=</span> <span class="va">mean</span><span class="op">)</span></span></code></pre></div>
<p><strong>B</strong></p>
<div class="sourceCode" id="cb1088"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">whale_selenium</span>, MARGIN <span class="op">=</span> <span class="fl">2</span>, FUN <span class="op">=</span> <span class="va">sd</span><span class="op">)</span></span></code></pre></div>
<p><strong>C</strong></p>
<div class="sourceCode" id="cb1089"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my.sem</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">sem</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">whale_selenium</span>, MARGIN <span class="op">=</span> <span class="fl">2</span>, FUN <span class="op">=</span> <span class="va">my.sem</span><span class="op">)</span></span></code></pre></div>
<p><strong>D</strong></p>
<div class="sourceCode" id="cb1090"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">whale_selenium</span><span class="op">$</span><span class="va">ratio</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">whale_selenium</span>, </span>
<span>            MARGIN <span class="op">=</span> <span class="fl">1</span>, </span>
<span>            FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>                    <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">/</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>            <span class="op">}</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">whale_selenium</span>, </span>
<span>       mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ratio</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Tooth / Liver Selenium ratio"</span>, title <span class="op">=</span> <span class="st">"Tooth / Liver Selenium ratios in whales"</span><span class="op">)</span></span></code></pre></div>
<p><strong>E</strong><br>
Inline expressions are like this: 15.4 MpH.</p>
</div>
<div id="urine-properties-1" class="section level3" number="19.9.2">
<h3>
<span class="header-section-number">19.9.2</span> Urine properties<a class="anchor" aria-label="anchor" href="#urine-properties-1"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb1091"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">urine_file_name</span> <span class="op">&lt;-</span> <span class="st">"urine.csv"</span></span>
<span><span class="va">url</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"https://raw.githubusercontent.com/MichielNoback/datasets/master/urine/"</span>, <span class="va">urine_file_name</span><span class="op">)</span></span>
<span><span class="va">local_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"../"</span>, <span class="va">urine_file_name</span><span class="op">)</span> <span class="co">#specifiy your own folder!</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/download.file.html">download.file</a></span><span class="op">(</span>url <span class="op">=</span> <span class="va">url</span>, destfile <span class="op">=</span> <span class="va">local_name</span><span class="op">)</span></span></code></pre></div>
<p><strong>A</strong></p>
<div class="sourceCode" id="cb1092"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">urine</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="va">local_name</span>, </span>
<span>                     sep <span class="op">=</span> <span class="st">","</span>,</span>
<span>                     header <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><strong>B</strong></p>
<div class="sourceCode" id="cb1093"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">urine</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"ox_crystals"</span></span>
<span><span class="va">urine</span><span class="op">$</span><span class="va">ox_crystals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">urine</span><span class="op">$</span><span class="va">ox_crystals</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"no"</span>, <span class="st">"yes"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><strong>C</strong></p>
<div class="sourceCode" id="cb1094"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mean_sd</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># returns a named vector</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"mean"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>, </span>
<span>      <span class="st">"sd"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">urine</span><span class="op">[</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span>, MARGIN <span class="op">=</span> <span class="fl">2</span>, FUN <span class="op">=</span> <span class="va">mean_sd</span><span class="op">)</span></span></code></pre></div>
<pre><code>##      gravity   ph osmo  cond urea calc
## mean    1.02 6.03  615 20.90  266 4.14
## sd      0.01 0.72  238  7.95  131 3.26</code></pre>
<p><strong>D</strong></p>
<div class="sourceCode" id="cb1096"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html">aggregate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">gravity</span>, <span class="va">ph</span>, <span class="va">osmo</span>, <span class="va">cond</span>, <span class="va">urea</span>, <span class="va">calc</span><span class="op">)</span> <span class="op">~</span> <span class="va">ox_crystals</span>, </span>
<span>          data <span class="op">=</span> <span class="va">urine</span>, </span>
<span>          FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>##   ox_crystals gravity   ph osmo cond urea calc
## 1          no    1.02 6.13  562 20.6  232 2.63
## 2         yes    1.02 5.93  683 21.4  302 6.20</code></pre>
</div>
</div>
<div id="data-mangling-with-dplyr-1" class="section level2" number="19.10">
<h2>
<span class="header-section-number">19.10</span> Data mangling with dplyr<a class="anchor" aria-label="anchor" href="#data-mangling-with-dplyr-1"><i class="fas fa-link"></i></a>
</h2>
<div id="global-temperature-revisited-1" class="section level3" number="19.10.1">
<h3>
<span class="header-section-number">19.10.1</span> Global temperature revisited<a class="anchor" aria-label="anchor" href="#global-temperature-revisited-1"><i class="fas fa-link"></i></a>
</h3>
<p><strong>A</strong> [❋]</p>
<div class="sourceCode" id="cb1098"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/MichielNoback/datasets/master/global_temperature/GLB.Ts%2BdSST.csv"</span></span>
<span><span class="co">#temp_dat &lt;- readr::read_csv(f)</span></span>
<span><span class="va">temp_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="va">f</span>, sep <span class="op">=</span> <span class="st">","</span>, header<span class="op">=</span><span class="cn">TRUE</span>, na.strings <span class="op">=</span> <span class="st">"***"</span><span class="op">)</span></span>
<span><span class="va">temp_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="va">temp_dat</span><span class="op">)</span></span></code></pre></div>
<p><strong>B</strong> [❋❋]</p>
<div class="sourceCode" id="cb1099"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">temp_dat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">JJA</span> <span class="op">&lt;</span> <span class="op">-</span><span class="fl">0.4</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">Year</span><span class="op">)</span></span></code></pre></div>
<p><strong>C</strong> [❋❋]</p>
<div class="sourceCode" id="cb1100"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># coldest</span></span>
<span><span class="va">cold</span> <span class="op">&lt;-</span> <span class="va">temp_dat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">J.D</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Year</span>, <span class="va">J.D</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="co"># warmest</span></span>
<span><span class="va">warm</span> <span class="op">&lt;-</span> <span class="va">temp_dat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">J.D</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Year</span>, <span class="va">J.D</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="co"># combine</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows</a></span><span class="op">(</span><span class="va">cold</span>, <span class="va">warm</span><span class="op">)</span></span></code></pre></div>
<p><strong>D</strong> [❋❋]</p>
<div class="sourceCode" id="cb1101"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">temp_dat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">MAM</span> <span class="op">&gt;</span> <span class="op">(</span><span class="va">JJA</span><span class="op">+</span><span class="fl">0.2</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Year</span>, <span class="va">MAM</span>, <span class="va">JJA</span><span class="op">)</span></span></code></pre></div>
<p><strong>E</strong> [❋❋❋]</p>
<div class="sourceCode" id="cb1102"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">decade_avg</span> <span class="op">&lt;-</span> <span class="va">temp_dat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Year</span> <span class="op">&gt;</span> <span class="fl">1969</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Decade <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">Year</span><span class="op">)</span>, <span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"0"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co"># there probably is a better way to do this...</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Year</span>, <span class="va">Decade</span>, <span class="va">DJF</span>, <span class="va">MAM</span>, <span class="va">JJA</span>, <span class="va">SON</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Decade</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="op">-</span><span class="va">Year</span>, <span class="va">mean</span>, na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb1103"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">decade_avg</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="op">-</span><span class="va">Decade</span>, </span>
<span>                 names_to <span class="op">=</span> <span class="st">"Season"</span>,</span>
<span>                 values_to <span class="op">=</span> <span class="st">"Anomaly"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Season <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">Season</span>, </span>
<span>                           levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"DJF"</span>, <span class="st">"MAM"</span>, <span class="st">"JJA"</span>, <span class="st">"SON"</span><span class="op">)</span>, </span>
<span>                           labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Winter"</span>, <span class="st">"Spring"</span>, <span class="st">"Summer"</span>, <span class="st">"Autumn"</span><span class="op">)</span>,</span>
<span>                           ordered <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Decade</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>weight <span class="op">=</span> <span class="va">Anomaly</span>, fill <span class="op">=</span> <span class="va">Season</span><span class="op">)</span>, position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><strong>F</strong> [❋❋❋❋]</p>
<div class="sourceCode" id="cb1104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">max_temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">temp_dat</span><span class="op">[</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">13</span><span class="op">]</span>, na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="va">temp_dat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">if_any</a></span><span class="op">(</span><span class="va">Jan</span><span class="op">:</span><span class="va">Dec</span>, <span class="op">~</span> <span class="va">.x</span> <span class="op">==</span> <span class="va">max_temp</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co">#across is deprecated</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Year</span>, <span class="va">J.D</span>, <span class="fu">where</span><span class="op">(</span><span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">.x</span>, na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="op">==</span> <span class="va">max_temp</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="pigs-1" class="section level3" number="19.10.2">
<h3>
<span class="header-section-number">19.10.2</span> Pigs<a class="anchor" aria-label="anchor" href="#pigs-1"><i class="fas fa-link"></i></a>
</h3>
<p><strong>A</strong> [❋]</p>
<div class="sourceCode" id="cb1105"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pigs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="st">"https://raw.githubusercontent.com/MichielNoback/datasets/master/pigs/dietox.csv"</span>, </span>
<span>                   header <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                   sep <span class="op">=</span> <span class="st">","</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">pigs</span><span class="op">)</span></span></code></pre></div>
<p><strong>B</strong> [❋❋]</p>
<div class="sourceCode" id="cb1106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pigs</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Time</span> <span class="op">==</span> <span class="fl">12</span> <span class="op">&amp;</span> <span class="va">Evit</span> <span class="op">==</span> <span class="fl">3</span> <span class="op">&amp;</span> <span class="va">Cu</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Pig</span>, <span class="va">Litter</span>, <span class="va">Feed</span>, <span class="va">Weight</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">Weight</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><strong>C</strong> [❋❋]</p>
<div class="sourceCode" id="cb1107"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pigs</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op">(</span><span class="va">Evit</span>, <span class="va">Cu</span><span class="op">)</span></span></code></pre></div>
<p><strong>D</strong> [❋❋❋]</p>
<div class="sourceCode" id="cb1108"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pigs</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Time</span> <span class="op">==</span> <span class="fl">12</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Evit</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>mean_weight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Weight</span><span class="op">)</span>,</span>
<span>              n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><strong>E</strong> [❋❋❋]</p>
<div class="sourceCode" id="cb1109"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gain</span> <span class="op">&lt;-</span> <span class="va">pigs</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Pig</span>, <span class="va">Time</span>, <span class="va">Weight</span>, <span class="va">Feed</span>, <span class="va">Evit</span>, <span class="va">Cu</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Pig</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Cu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">Cu</span><span class="op">)</span>,</span>
<span>           Evit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">Evit</span><span class="op">)</span>,</span>
<span>           Lag_Weight <span class="op">=</span> <span class="fu">lag</span><span class="op">(</span><span class="va">Weight</span><span class="op">)</span>,</span>
<span>           Gain <span class="op">=</span> <span class="op">(</span><span class="va">Weight</span> <span class="op">-</span> <span class="va">Lag_Weight</span><span class="op">)</span><span class="op">/</span><span class="va">Lag_Weight</span><span class="op">*</span><span class="fl">100</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">gain</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Cu</span>, y <span class="op">=</span> <span class="va">Gain</span>, color <span class="op">=</span> <span class="va">Cu</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html">geom_violin</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Evit</span><span class="op">)</span></span></code></pre></div>
<p><strong>F</strong> [❋❋❋]</p>
<div class="sourceCode" id="cb1110"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># select and pivot</span></span>
<span><span class="va">pigs</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">X</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">Time</span>,</span>
<span>                names_prefix <span class="op">=</span> <span class="st">"w_"</span>,</span>
<span>                values_from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">Weight</span>, <span class="va">Feed</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="population-numbers-1" class="section level3" number="19.10.3">
<h3>
<span class="header-section-number">19.10.3</span> Population numbers<a class="anchor" aria-label="anchor" href="#population-numbers-1"><i class="fas fa-link"></i></a>
</h3>
<p><strong>A</strong> [❋]</p>
<div class="sourceCode" id="cb1111"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pop_data_file</span> <span class="op">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/MichielNoback/datasets/master/population/EDU_DEM_05022020113225751.csv"</span></span>
<span><span class="va">population</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="va">pop_data_file</span>,</span>
<span>                         header <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                         sep<span class="op">=</span><span class="st">","</span><span class="op">)</span></span></code></pre></div>
<p><strong>B</strong> [❋❋]<br><strong>Which?</strong>
<code>str(population)</code> tells me that <code>Unit.Code</code>, <code>Unit</code> and <code>PowerCode</code> are factors with one level. Using <code>table(population$PowerCode.Code, useNA = "always")</code> tells me that there are only zeros there. Same for <code>Reference.Period.Code</code> and <code>Reference.Period</code>. The variables <code>Flags</code> and <code>Flag.Codes</code> refer to the same, so one of them can be removed (I choose to remove <code>Flag.Codes</code>). The same counts for <code>SEX</code>/<code>Sex</code>, <code>AGE</code>/<code>Age</code> and <code>YEAR</code>/<code>Year</code>.</p>
<p><strong>Select</strong>
This is my selection:</p>
<div class="sourceCode" id="cb1112"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">keep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">population</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">6</span>, <span class="fl">8</span>, <span class="fl">15</span>, <span class="fl">16</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">keep</span></span>
<span><span class="va">population</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="va">population</span><span class="op">[</span>, <span class="va">keep</span><span class="op">]</span><span class="op">)</span> <span class="co">#tibble is nicer!</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">population</span><span class="op">)</span></span></code></pre></div>
<p><strong>C</strong> [❋❋❋]</p>
<div class="sourceCode" id="cb1113"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pop_totals</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">population</span>, <span class="va">Sex</span> <span class="op">==</span> <span class="st">"Total"</span> <span class="op">&amp;</span> <span class="va">Age</span> <span class="op">==</span> <span class="st">"Total: All age groups"</span><span class="op">)</span></span>
<span><span class="co">##or, using base R</span></span>
<span><span class="co">#population[population$Sex == "Total" &amp; population$Age == "Total: All age groups", ]</span></span>
<span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">pop_totals</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">5</span>, <span class="fl">6</span><span class="op">)</span><span class="op">]</span>,</span>
<span>    names_from <span class="op">=</span> <span class="va">Year</span>,</span>
<span>    values_from <span class="op">=</span> <span class="va">Value</span><span class="op">)</span></span></code></pre></div>
<p><strong>D</strong> [❋❋❋❋]<br>
You could do this on the <code>pop_totals</code> dataset using the <code>lag()</code> function, after using <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code>, but since we have the wide format, you could also use a simple <code>for</code> loop, iterating the columns by index and subtracting the first from the second. I will demonstrate the only the first.</p>
<div class="sourceCode" id="cb1114"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pop_totals</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Country</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Pop_change <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span><span class="va">Value</span> <span class="op">-</span> <span class="fu">lag</span><span class="op">(</span><span class="va">Value</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">Value</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">Year</span>,</span>
<span>        values_from <span class="op">=</span> <span class="va">Pop_change</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">`2005`</span>, <span class="op">-</span><span class="va">`2010`</span>, <span class="op">-</span><span class="va">Flag.Codes</span><span class="op">)</span> </span>
<span><span class="co">## backticks in above selection are required </span></span>
<span><span class="co">## because we are selecting names that are numbers!</span></span></code></pre></div>
<p><strong>E</strong> [❋❋❋]</p>
<div class="sourceCode" id="cb1115"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sel</span> <span class="op">&lt;-</span> <span class="va">population</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Sex</span> <span class="op">==</span> <span class="st">"Women"</span> <span class="op">|</span> <span class="va">Sex</span> <span class="op">==</span> <span class="st">"Men"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">COUNTRY</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"BEL"</span>, <span class="st">"CHE"</span>, <span class="st">"DNK"</span>, <span class="st">"FRA"</span>, <span class="st">"IRL"</span>, <span class="st">"DEU"</span>, <span class="st">"LUX"</span>, <span class="st">"NLD"</span>, <span class="st">"GBR"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">sel</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">Year</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>weight <span class="op">=</span> <span class="va">Value</span>, fill <span class="op">=</span> <span class="va">Sex</span><span class="op">)</span><span class="op">)</span>  <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="va">.</span> <span class="op">~</span> <span class="va">COUNTRY</span><span class="op">)</span></span></code></pre></div>
<p><strong>F</strong> [❋❋❋❋]</p>
<div class="sourceCode" id="cb1116"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">population</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Sex</span> <span class="op">==</span> <span class="st">"Total"</span> <span class="op">&amp;</span> <span class="va">Age</span> <span class="op">==</span> <span class="st">"Total: All age groups"</span> <span class="op">&amp;</span> <span class="op">(</span><span class="va">Year</span> <span class="op">==</span> <span class="fl">2005</span> <span class="op">|</span> <span class="va">Year</span> <span class="op">==</span> <span class="fl">2017</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Country</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Change <span class="op">=</span> <span class="va">Value</span> <span class="op">-</span> <span class="fu">lag</span><span class="op">(</span><span class="va">Value</span><span class="op">)</span>, </span>
<span>           Previous <span class="op">=</span> <span class="fu">lag</span><span class="op">(</span><span class="va">Value</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>GrowthRate <span class="op">=</span> <span class="va">Change</span> <span class="op">/</span> <span class="va">Previous</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">COUNTRY</span>, <span class="va">Country</span>, <span class="va">GrowthRate</span> <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">GrowthRate</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div id="text-processing-with-regex-1" class="section level2" number="19.11">
<h2>
<span class="header-section-number">19.11</span> Text processing with regex<a class="anchor" aria-label="anchor" href="#text-processing-with-regex-1"><i class="fas fa-link"></i></a>
</h2>
<div id="restriction-enzymes-2" class="section level3" number="19.11.1">
<h3>
<span class="header-section-number">19.11.1</span> Restriction enzymes<a class="anchor" aria-label="anchor" href="#restriction-enzymes-2"><i class="fas fa-link"></i></a>
</h3>
<p><strong>A</strong> [❋❋]</p>
<div class="sourceCode" id="cb1117"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pacI_re</span> <span class="op">&lt;-</span> <span class="st">"TTAATTAA"</span></span>
<span><span class="va">patterns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"T{2}A{2}T{2}A{2}"</span>,</span>
<span>           <span class="st">"(TTAA){2}"</span>,</span>
<span>           <span class="st">"(T{2}A{2}){2}"</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">ptrn</span> <span class="kw">in</span> <span class="va">patterns</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="va">ptrn</span>, <span class="va">pacI_re</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><strong>B</strong> [❋❋]</p>
<div class="sourceCode" id="cb1118"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sfiI_re</span> <span class="op">&lt;-</span> <span class="st">"GGCCACGTAGGCC"</span></span>
<span><span class="va">patterns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"G{2}C{2}[GATC]{5}G{2}C{2}"</span>,</span>
<span>           <span class="st">"GGCC[GATC]{5}GGCC"</span>,</span>
<span>           <span class="st">"[GC]{4}[GATC]{5}[GC]{4}"</span><span class="op">)</span> <span class="co">#last one is less specific!</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">ptrn</span> <span class="kw">in</span> <span class="va">patterns</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="va">ptrn</span>, <span class="va">sfiI_re</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div id="prosite-patterns-1" class="section level3" number="19.11.2">
<h3>
<span class="header-section-number">19.11.2</span> Prosite Patterns<a class="anchor" aria-label="anchor" href="#prosite-patterns-1"><i class="fas fa-link"></i></a>
</h3>
<p><strong>A</strong> [❋❋]<br>
PS00211:
“[LIVMFYC]-[SA]-[SAPGLVFYKQH]-G-[DENQMW]-[KRQASPCLIMFW]-[KRNQSTAVM]-[KRACLVM]-[LIVMFYPAN]-{PHY}-[LIVMFW]-[SAGCLIVP]-{FYWHP}-{KRHP}-[LIVMFYWSTA].”</p>
<div class="sourceCode" id="cb1119"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">PS00211</span><span class="op">&lt;-</span> <span class="st">"[LIVMFYC][SA][SAPGLVFYKQH]G[DENQMW][KRQASPCLIMFW][KRNQSTAVM][KRACLVM][LIVMFYPAN][^PHY][LIVMFW][SAGCLIVP][^FYWHP][^KRHP][LIVMFYWSTA]"</span></span></code></pre></div>
<p><strong>B</strong> [❋❋]<br>
PS00018:
“D-{W}-[DNS]-{ILVFYW}-[DENSTG]-[DNQGHRK]-{GP}-[LIVMC]-[DENQSTAGC]-x(2)- [DE]-[LIVMFYW].”</p>
<div class="sourceCode" id="cb1120"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">PS00018</span> <span class="op">&lt;-</span> <span class="st">"D[^W][DNS][^ILVFYW][DENSTG][DNQGHRK][^GP][LIVMC][DENQSTAGC].{2} [DE][LIVMFYW]"</span></span></code></pre></div>
</div>
<div id="fasta-headers-1" class="section level3" number="19.11.3">
<h3>
<span class="header-section-number">19.11.3</span> Fasta Headers<a class="anchor" aria-label="anchor" href="#fasta-headers-1"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb1121"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org">stringr</a></span><span class="op">)</span></span>
<span><span class="va">fasta_headers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readLines.html">readLines</a></span><span class="op">(</span><span class="st">"./data/fasta_headers.txt"</span><span class="op">)</span></span></code></pre></div>
<p><strong>A</strong> [❋❋❋]</p>
<div class="sourceCode" id="cb1122"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_match.html">str_match</a></span><span class="op">(</span><span class="va">fasta_headers</span>, <span class="st">"\\[(.+)\\]"</span><span class="op">)</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_match.html">str_match</a></span><span class="op">(</span><span class="va">fasta_headers</span>, <span class="st">"\\[([[:alpha:]]+ [[:alpha:]]+) ?(.+)?\\]"</span><span class="op">)</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span></span></code></pre></div>
<p><strong>B</strong> [❋❋❋]</p>
<div class="sourceCode" id="cb1123"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_match.html">str_match</a></span><span class="op">(</span><span class="va">fasta_headers</span>, <span class="st">"&gt;([[:alpha:]]{2,3}\\|\\w+)\\|"</span><span class="op">)</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span></span></code></pre></div>
<p><strong>C</strong> [❋❋❋]</p>
<div class="sourceCode" id="cb1124"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_match.html">str_match</a></span><span class="op">(</span><span class="va">fasta_headers</span>, <span class="st">"&gt;.+\\| (.+?) \\["</span><span class="op">)</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span></span></code></pre></div>
</div>
</div>
<div id="package-ggplot2-revisited-1" class="section level2" number="19.12">
<h2>
<span class="header-section-number">19.12</span> Package ggplot2 revisited<a class="anchor" aria-label="anchor" href="#package-ggplot2-revisited-1"><i class="fas fa-link"></i></a>
</h2>
<div id="eye-colors-1" class="section level3" number="19.12.1">
<h3>
<span class="header-section-number">19.12.1</span> Eye colors<a class="anchor" aria-label="anchor" href="#eye-colors-1"><i class="fas fa-link"></i></a>
</h3>
<p><strong>A</strong> [❋❋]</p>
<div class="sourceCode" id="cb1125"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">ec_data</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"data/eyecolor_data.csv"</span>, </span>
<span>                            col_types <span class="op">=</span> <span class="st">"cfiffffffff"</span>,</span>
<span>                            na<span class="op">=</span><span class="st">"-"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><strong>B</strong> [❋❋❋]</p>
<div class="sourceCode" id="cb1126"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ec_data</span> <span class="op">&lt;-</span> <span class="va">ec_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fl">4</span><span class="op">:</span><span class="fl">11</span>, <span class="op">~</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html">recode_factor</a></span><span class="op">(</span><span class="va">.x</span>, blauw <span class="op">=</span> <span class="st">"blue"</span>, bruin <span class="op">=</span> <span class="st">"brown"</span>, groen <span class="op">=</span> <span class="st">"green"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><strong>C</strong> [❋❋❋❋]</p>
<div class="sourceCode" id="cb1127"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Majority for use in mutate()</span></span>
<span><span class="va">majority</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co">#print(as.character(x))</span></span>
<span>    <span class="co"># there are many other approaches to be taken</span></span>
<span>    <span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="co"># one entry = no problem</span></span>
<span>    <span class="kw">else</span> <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="st">"intermediate"</span><span class="op">)</span> <span class="co"># same counts = no majority</span></span>
<span>    <span class="kw">else</span><span class="op">{</span></span>
<span>        <span class="co"># order by count and return the most abundant one</span></span>
<span>        <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Freq</span>, decreasing <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># mutate to apply the function</span></span>
<span><span class="co"># this requires rowwise() and c_across()</span></span>
<span><span class="va">ec_data</span> <span class="op">&lt;-</span> <span class="va">ec_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rowwise.html">rowwise</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>majority <span class="op">=</span> <span class="fu">majority</span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/c_across.html">c_across</a></span><span class="op">(</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><strong>D</strong> [❋❋❋]</p>
<div class="sourceCode" id="cb1128"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ec_data_tidy</span> <span class="op">&lt;-</span> <span class="va">ec_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">Identifier</span>, <span class="va">sex</span>, <span class="va">age</span>, <span class="va">majority</span><span class="op">)</span>,</span>
<span>                 names_sep <span class="op">=</span> <span class="st">"_"</span>,</span>
<span>                 names_to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"eye"</span>, <span class="st">"experimenter"</span><span class="op">)</span>,</span>
<span>                 values_to <span class="op">=</span> <span class="st">"observed_color"</span><span class="op">)</span></span></code></pre></div>
<p><strong>E</strong> [❋❋❋]</p>
<div class="sourceCode" id="cb1129"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## create the contingency table</span></span>
<span><span class="va">counts</span> <span class="op">&lt;-</span> <span class="va">ec_data_tidy</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">sex</span>, <span class="va">eye</span>, <span class="va">observed_color</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">sex</span>, <span class="va">eye</span>, <span class="va">observed_color</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>count <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span> </span>
<span></span>
<span><span class="co">## The balloon plot. Not that quotes around variables are required!</span></span>
<span><span class="fu">ggpubr</span><span class="fu">::</span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggballoonplot.html">ggballoonplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">counts</span>, </span>
<span>                      x <span class="op">=</span> <span class="st">'eye'</span>, </span>
<span>                      y <span class="op">=</span> <span class="st">'observed_color'</span>, </span>
<span>                      facet.by <span class="op">=</span> <span class="st">'sex'</span>, </span>
<span>                      size <span class="op">=</span> <span class="st">'count'</span>,</span>
<span>                      fill <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div id="working-with-date-time-data" class="section level2" number="19.13">
<h2>
<span class="header-section-number">19.13</span> Working with date-time data<a class="anchor" aria-label="anchor" href="#working-with-date-time-data"><i class="fas fa-link"></i></a>
</h2>
<div id="bacterial-growth-1" class="section level3" number="19.13.1">
<h3>
<span class="header-section-number">19.13.1</span> Bacterial growth<a class="anchor" aria-label="anchor" href="#bacterial-growth-1"><i class="fas fa-link"></i></a>
</h3>
<p><strong>A</strong> [❋❋]</p>
<div class="sourceCode" id="cb1130"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bact_growth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="st">'data/growth-exp-data.csv'</span>, </span>
<span>           sep <span class="op">=</span> <span class="st">";"</span>,</span>
<span>           header <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><strong>B</strong> [❋❋]</p>
<div class="sourceCode" id="cb1131"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bact_growth</span> <span class="op">&lt;-</span> <span class="va">bact_growth</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unite.html">unite</a></span><span class="op">(</span><span class="va">date_time</span>, <span class="va">date</span>, <span class="va">time</span>, sep<span class="op">=</span><span class="st">"@"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>date_time <span class="op">=</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd_hms.html">dmy_hm</a></span><span class="op">(</span><span class="va">date_time</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><strong>C</strong> [❋❋❋]</p>
<div class="sourceCode" id="cb1132"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">start</span> <span class="op">&lt;-</span> <span class="va">bact_growth</span><span class="op">$</span><span class="va">date_time</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">bact_growth</span> <span class="op">&lt;-</span> </span>
<span>    <span class="va">bact_growth</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>elapsed_time <span class="op">=</span> <span class="fu">hour</span><span class="op">(</span><span class="fu">seconds_to_period</span><span class="op">(</span><span class="va">date_time</span> <span class="op">-</span> <span class="va">start</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><strong>D</strong> [❋❋❋]</p>
<div class="sourceCode" id="cb1133"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Value used to transform the data of the second axis</span></span>
<span><span class="va">coeff</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span></span>
<span><span class="va">OD_color</span> <span class="op">&lt;-</span> <span class="st">"#69b3a2"</span></span>
<span><span class="va">glucose_color</span> <span class="op">&lt;-</span> <span class="st">"deepskyblue3"</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bact_growth</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">elapsed_time</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">OD600</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="va">OD_color</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">glucose</span> <span class="op">/</span> <span class="va">coeff</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="va">glucose_color</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    <span class="co"># Features of the first axis</span></span>
<span>    name <span class="op">=</span> <span class="st">"OD600"</span>,</span>
<span>    <span class="co"># Add a second axis and specify its features</span></span>
<span>    sec.axis <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/sec_axis.html">sec_axis</a></span><span class="op">(</span><span class="op">~</span> <span class="va">.</span> <span class="op">*</span> <span class="va">coeff</span>, name <span class="op">=</span> <span class="st">"Glucose level"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"elapsed time (h)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    axis.title.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">OD_color</span>, size<span class="op">=</span><span class="fl">13</span><span class="op">)</span>,</span>
<span>    axis.title.y.right <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">glucose_color</span>, size<span class="op">=</span><span class="fl">13</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="exercises.html"><span class="header-section-number">18</span> Exercises</a></div>
<div class="empty"></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#exercise-solutions"><span class="header-section-number">19</span> Exercise solutions</a></li>
<li>
<a class="nav-link" href="#getting-started-3"><span class="header-section-number">19.1</span> Getting started</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#install-the-tools-1"><span class="header-section-number">19.1.1</span> Install the tools</a></li></ul>
</li>
<li>
<a class="nav-link" href="#the-toolbox-1"><span class="header-section-number">19.2</span> The toolbox</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#customize-rstudio-1"><span class="header-section-number">19.2.1</span> Customize RStudio</a></li>
<li><a class="nav-link" href="#r%C3%A9sum%C3%A9"><span class="header-section-number">19.2.2</span> Résumé</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#basic-r-2"><span class="header-section-number">19.3</span> Basic R</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#math-in-the-console-1"><span class="header-section-number">19.3.1</span> Math in the console</a></li>
<li><a class="nav-link" href="#functions-i-1"><span class="header-section-number">19.3.2</span> Functions (I)</a></li>
<li><a class="nav-link" href="#variables-2"><span class="header-section-number">19.3.3</span> Variables</a></li>
<li><a class="nav-link" href="#vectors-2"><span class="header-section-number">19.3.4</span> Vectors</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#complex-datatypes-1"><span class="header-section-number">19.4</span> Complex datatypes</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#creating-factors-1"><span class="header-section-number">19.4.1</span> Creating factors</a></li>
<li><a class="nav-link" href="#list-actions-1"><span class="header-section-number">19.4.2</span> List actions</a></li>
<li><a class="nav-link" href="#named-vectors-1"><span class="header-section-number">19.4.3</span> Named vectors</a></li>
<li><a class="nav-link" href="#lowry-1"><span class="header-section-number">19.4.4</span> Lowry</a></li>
<li><a class="nav-link" href="#island-surfaces-1"><span class="header-section-number">19.4.5</span> Island surfaces</a></li>
<li><a class="nav-link" href="#usarrests-1"><span class="header-section-number">19.4.6</span> USArrests</a></li>
<li><a class="nav-link" href="#file-reading-practice-1"><span class="header-section-number">19.4.7</span> File reading practice</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#basics-of-the-ggplot2-package-1"><span class="header-section-number">19.5</span> Basics of the ggplot2 package</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#trees-1"><span class="header-section-number">19.5.1</span> Trees</a></li>
<li><a class="nav-link" href="#insect-sprays-1"><span class="header-section-number">19.5.2</span> Insect Sprays</a></li>
<li><a class="nav-link" href="#pharmacokinetics-1"><span class="header-section-number">19.5.3</span> Pharmacokinetics</a></li>
<li><a class="nav-link" href="#usarrests-ii-1"><span class="header-section-number">19.5.4</span> USArrests (II)</a></li>
<li><a class="nav-link" href="#orchard-sprays-1"><span class="header-section-number">19.5.5</span> Orchard Sprays</a></li>
<li><a class="nav-link" href="#diauxic-growth-1"><span class="header-section-number">19.5.6</span> Diauxic growth</a></li>
<li><a class="nav-link" href="#virginia-death-rates-1"><span class="header-section-number">19.5.7</span> Virginia Death Rates</a></li>
<li><a class="nav-link" href="#global-temperature-1"><span class="header-section-number">19.5.8</span> Global temperature</a></li>
<li><a class="nav-link" href="#investigate-new-visualization-1"><span class="header-section-number">19.5.9</span> Investigate new visualization</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#functions-ii-1"><span class="header-section-number">19.6</span> Functions (II)</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#cut-1"><span class="header-section-number">19.6.1</span> cut()</a></li>
<li><a class="nav-link" href="#quantile-1"><span class="header-section-number">19.6.2</span> quantile()</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#flow-control-and-scripting-2"><span class="header-section-number">19.7</span> Flow control and scripting</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#illegal-reproductions-1"><span class="header-section-number">19.7.1</span> Illegal reproductions</a></li>
<li><a class="nav-link" href="#various-other-functions-1"><span class="header-section-number">19.7.2</span> Various other functions</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#tidying-dataframes-using-package-tidyr-1"><span class="header-section-number">19.8</span> Tidying dataframes using Package tidyr</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#small-examples-1"><span class="header-section-number">19.8.1</span> Small examples</a></li>
<li><a class="nav-link" href="#lung-cancer-1"><span class="header-section-number">19.8.2</span> Lung cancer</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#old-school-data-mangling-1"><span class="header-section-number">19.9</span> Old school data mangling</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#whale-selenium-1"><span class="header-section-number">19.9.1</span> Whale selenium</a></li>
<li><a class="nav-link" href="#urine-properties-1"><span class="header-section-number">19.9.2</span> Urine properties</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#data-mangling-with-dplyr-1"><span class="header-section-number">19.10</span> Data mangling with dplyr</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#global-temperature-revisited-1"><span class="header-section-number">19.10.1</span> Global temperature revisited</a></li>
<li><a class="nav-link" href="#pigs-1"><span class="header-section-number">19.10.2</span> Pigs</a></li>
<li><a class="nav-link" href="#population-numbers-1"><span class="header-section-number">19.10.3</span> Population numbers</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#text-processing-with-regex-1"><span class="header-section-number">19.11</span> Text processing with regex</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#restriction-enzymes-2"><span class="header-section-number">19.11.1</span> Restriction enzymes</a></li>
<li><a class="nav-link" href="#prosite-patterns-1"><span class="header-section-number">19.11.2</span> Prosite Patterns</a></li>
<li><a class="nav-link" href="#fasta-headers-1"><span class="header-section-number">19.11.3</span> Fasta Headers</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#package-ggplot2-revisited-1"><span class="header-section-number">19.12</span> Package ggplot2 revisited</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#eye-colors-1"><span class="header-section-number">19.12.1</span> Eye colors</a></li></ul>
</li>
<li>
<a class="nav-link" href="#working-with-date-time-data"><span class="header-section-number">19.13</span> Working with date-time data</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#bacterial-growth-1"><span class="header-section-number">19.13.1</span> Bacterial growth</a></li></ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Data Analysis and Visualization using R</strong>" was written by Michiel Noback. It was last built on 2024-03-14.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
